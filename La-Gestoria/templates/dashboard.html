{% extends "base.html" %}

{% block title %}Dashboard - GestorTaxi Pro{% endblock %}

{% block content %}
<div class="flex h-screen bg-gray-100" x-data="dashboard()">
    <!-- Sidebar -->
    <div class="w-64 bg-gray-900 shadow-xl flex flex-col h-full">
        <div class="p-6 border-b border-gray-700 flex-shrink-0">
            <div class="flex items-center space-x-2">
                <i class="fas fa-taxi text-2xl text-blue-400"></i>
                <h1 class="text-xl font-bold text-white">GestorTaxi Pro</h1>
            </div>
        </div>
        
        <nav class="mt-6 flex-1 overflow-y-auto">
            <div class="px-4 space-y-1 pb-20">
                <!-- Inicio -->
                <button @click="loadSection('inicio')" :class="currentSection === 'inicio' ? 'bg-blue-600 text-white' : 'text-gray-300 hover:bg-gray-800 hover:text-white'"
                        class="w-full flex items-center px-4 py-3 text-left rounded-lg transition-all duration-200 mb-2">
                    <i class="fas fa-home mr-3 text-sm"></i>
                    <span class="font-medium">Inicio</span>
                </button>
                
                <!-- Laboral -->
                <div x-data="{ expanded: false }" class="mb-2">
                    <button @click="expanded = !expanded" 
                            class="w-full flex items-center justify-between px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white rounded-lg transition-all duration-200">
                        <div class="flex items-center">
                            <i class="fas fa-users-cog mr-3 text-sm"></i>
                            <span class="font-medium">Laboral</span>
                        </div>
                        <i class="fas fa-chevron-down transform transition-transform duration-200 text-xs" :class="expanded ? 'rotate-180' : ''"></i>
                    </button>
                    <div x-show="expanded" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0 -translate-y-1" x-transition:enter-end="opacity-100 translate-y-0" class="ml-6 mt-2 space-y-1 border-l border-gray-700 pl-4">
                        <button @click="openModal('altas-empleados')" :class="currentSection === 'altas-empleados' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-700 hover:text-gray-200'"
                                class="w-full flex items-center px-3 py-2 text-left rounded-md transition-all duration-200 text-sm">
                            <i class="fas fa-user-plus mr-3 text-xs w-4"></i>
                            <span>Altas de empleados</span>
                        </button>
                        <button @click="openModal('bajas-empleados')" :class="currentSection === 'bajas-empleados' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-700 hover:text-gray-200'"
                                class="w-full flex items-center px-3 py-2 text-left rounded-md transition-all duration-200 text-sm">
                            <i class="fas fa-user-minus mr-3 text-xs w-4"></i>
                            <span>Bajas de empleados</span>
                        </button>
                        <button @click="openModal('nominas')" :class="currentSection === 'nominas' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-money-check mr-3 text-xs"></i>
                            Nóminas
                        </button>
                        <button @click="openModal('contratos-trabajo')" :class="currentSection === 'contratos-trabajo' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-file-contract mr-3 text-xs"></i>
                            Contratos de trabajo
                        </button>
                        <button @click="openModal('enviar-nominas')" :class="currentSection === 'enviar-nominas' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-paper-plane mr-3 text-xs"></i>
                            Enviar nóminas mensual
                        </button>
                        <button @click="openModal('calendario-vacaciones')" :class="currentSection === 'calendario-vacaciones' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-calendar-check mr-3 text-xs"></i>
                            Calendario de vacaciones
                        </button>
                        <button @click="openModal('liquidacion-ss')" :class="currentSection === 'liquidacion-ss' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-shield-alt mr-3 text-xs"></i>
                            Liquidación de cuotas S.S
                        </button>
                        <button @click="openModal('constitucion-empresas')" :class="currentSection === 'constitucion-empresas' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-building mr-3 text-xs"></i>
                            Constitución de empresas
                        </button>
                    </div>
                </div>
                
                <!-- Fiscal -->
                <div x-data="{ expanded: false }" class="mb-2">
                    <button @click="expanded = !expanded" 
                            class="w-full flex items-center justify-between px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white rounded-lg transition-all duration-200">
                        <div class="flex items-center">
                            <i class="fas fa-calculator mr-3 text-sm"></i>
                            <span class="font-medium">Fiscal</span>
                        </div>
                        <i class="fas fa-chevron-down transform transition-transform duration-200 text-xs" :class="expanded ? 'rotate-180' : ''"></i>
                    </button>
                    <div x-show="expanded" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0 -translate-y-1" x-transition:enter-end="opacity-100 translate-y-0" class="ml-6 mt-2 space-y-1 border-l border-gray-700 pl-4">
                        <button @click="openModal('modelos-aeat')" :class="currentSection === 'modelos-aeat' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-file-invoice mr-3 text-xs"></i>
                            Modelos AEAT
                        </button>
                        <button @click="openModal('alta-autonomo-empresa')" :class="currentSection === 'alta-autonomo-empresa' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-user-tie mr-3 text-xs"></i>
                            Alta autónomo/empresa
                        </button>
                        <button @click="openModal('libros-obligatorios')" :class="currentSection === 'libros-obligatorios' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-book mr-3 text-xs"></i>
                            Libros obligatorios
                        </button>
                        <button @click="openModal('calendario-fiscal')" :class="currentSection === 'calendario-fiscal' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-700 hover:text-gray-200'"
                                class="w-full flex items-center px-3 py-2 text-left rounded-md transition-all duration-200 text-sm">
                            <i class="fas fa-calendar-alt mr-3 text-xs w-4"></i>
                            <span>Calendario fiscal automático</span>
                        </button>
                        <button @click="openModal('historico-modelos')" :class="currentSection === 'historico-modelos' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-history mr-3 text-xs"></i>
                            Histórico de modelos
                        </button>
                        <button @click="openModal('notificaciones-ayuda')" :class="currentSection === 'notificaciones-ayuda' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-bell mr-3 text-xs"></i>
                            Notificaciones y ayuda
                        </button>
                    </div>
                </div>
                
                <!-- Contable -->
                <div x-data="{ expanded: false }">
                    <button @click="expanded = !expanded" 
                            class="w-full flex items-center justify-between px-4 py-3 text-gray-300 hover:bg-gray-800 rounded-lg transition">
                        <div class="flex items-center">
                            <i class="fas fa-chart-line mr-3"></i>
                            Contable
                        </div>
                        <i class="fas fa-chevron-down transform transition-transform" :class="expanded ? 'rotate-180' : ''"></i>
                    </button>
                    <div x-show="expanded" x-transition class="ml-4 mt-2 space-y-1">
                        <button @click="openModal('libro-ingresos')" :class="currentSection === 'libro-ingresos' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-plus-circle mr-3 text-xs"></i>
                            Libro de ingresos
                        </button>
                        <button @click="openModal('libro-gastos')" :class="currentSection === 'libro-gastos' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-minus-circle mr-3 text-xs"></i>
                            Libro de gastos
                        </button>
                        <button @click="currentSection = 'extractos-bancarios'" :class="currentSection === 'extractos-bancarios' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-university mr-3 text-xs"></i>
                            Extractos bancarios
                        </button>
                        <button @click="currentSection = 'balance-fiscal'" :class="currentSection === 'balance-fiscal' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-balance-scale mr-3 text-xs"></i>
                            Balance fiscal
                        </button>
                    </div>
                </div>
                
                <!-- Área VTC -->
                <div x-data="{ expanded: false }">
                    <button @click="expanded = !expanded" 
                            class="w-full flex items-center justify-between px-4 py-3 text-gray-300 hover:bg-gray-800 rounded-lg transition">
                        <div class="flex items-center">
                            <i class="fas fa-car-side mr-3"></i>
                            Área VTC
                        </div>
                        <i class="fas fa-chevron-down transform transition-transform" :class="expanded ? 'rotate-180' : ''"></i>
                    </button>
                    <div x-show="expanded" x-transition class="ml-4 mt-2 space-y-1">
                        <button @click="openModal('rehabilitar-autorizacion')" :class="currentSection === 'rehabilitar-autorizacion' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-redo mr-3 text-xs"></i>
                            Rehabilitar autorización
                        </button>
                        <button @click="openModal('transmitir-autorizacion')" :class="currentSection === 'transmitir-autorizacion' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-exchange-alt mr-3 text-xs"></i>
                            Transmitir autorización
                        </button>
                        <button @click="openModal('renunciar-autorizacion')" :class="currentSection === 'renunciar-autorizacion' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-times-circle mr-3 text-xs"></i>
                            Renunciar autorización
                        </button>
                        <button @click="openModal('reducir-flota')" :class="currentSection === 'reducir-flota' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-minus mr-3 text-xs"></i>
                            Reducir flota
                        </button>
                        <button @click="openModal('sustituir-vehiculo-vtc')" :class="currentSection === 'sustituir-vehiculo' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-sync-alt mr-3 text-xs"></i>
                            Sustituir vehículo
                        </button>
                        <button @click="openModal('sustitucion-provisional')" :class="currentSection === 'sustitucion-provisional' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-tools mr-3 text-xs"></i>
                            Sustitución provisional
                        </button>
                        <button @click="openModal('cambiar-domicilio')" :class="currentSection === 'cambiar-domicilio' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-home mr-3 text-xs"></i>
                            Cambiar domicilio
                        </button>
                        <button @click="openModal('distintivo-vtc')" :class="currentSection === 'distintivo-vtc' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-award mr-3 text-xs"></i>
                            Distintivo VTC
                        </button>
                        <button @click="openModal('renovar-autorizacion-vtc')" :class="currentSection === 'renovar-autorizacion' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-stamp mr-3 text-xs"></i>
                            Renovar autorización (Visar)
                        </button>
                    </div>
                </div>
                
                <!-- Área Taxi -->
                <div x-data="{ expanded: false }">
                    <button @click="expanded = !expanded" 
                            class="w-full flex items-center justify-between px-4 py-3 text-gray-300 hover:bg-gray-800 rounded-lg transition">
                        <div class="flex items-center">
                            <i class="fas fa-taxi mr-3"></i>
                            Área Taxi
                        </div>
                        <i class="fas fa-chevron-down transform transition-transform" :class="expanded ? 'rotate-180' : ''"></i>
                    </button>
                    <div x-show="expanded" x-transition class="ml-4 mt-2 space-y-1">
                        <button @click="openModal('renovacion-vt')" :class="currentSection === 'renovacion-vt' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-id-card mr-3 text-xs"></i>
                            Renovación VT
                        </button>
                        <button @click="openModal('revision-metropolitana')" :class="currentSection === 'revision-metropolitana' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-clipboard-check mr-3 text-xs"></i>
                            Revisión metropolitana
                        </button>
                        <button @click="openModal('altas-bajas-vehiculos-taxi')" :class="currentSection === 'altas-bajas-vehiculos' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-car mr-3 text-xs"></i>
                            Altas y bajas vehículos
                        </button>
                        <button @click="openModal('altas-bajas-asalariados-taxi')" :class="currentSection === 'altas-bajas-asalariados' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-users mr-3 text-xs"></i>
                            Altas y bajas asalariados
                        </button>
                        <button @click="openModal('altas-autonomos-familiares')" :class="currentSection === 'altas-autonomos-familiares' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-user-friends mr-3 text-xs"></i>
                            Altas autónomos/familiares
                        </button>
                        <button @click="openModal('sustituir-vehiculo-taxi')" :class="currentSection === 'sustituir-vehiculo-taxi' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-sync-alt mr-3 text-xs"></i>
                            Sustituir vehículo
                        </button>
                    </div>
                </div>
                
                <!-- Gastos -->
                <div x-data="{ expanded: false }">
                    <button @click="expanded = !expanded" 
                            class="w-full flex items-center justify-between px-4 py-3 text-gray-300 hover:bg-gray-800 rounded-lg transition">
                        <div class="flex items-center">
                            <i class="fas fa-minus-circle mr-3"></i>
                            Gastos
                        </div>
                        <i class="fas fa-chevron-down transform transition-transform" :class="expanded ? 'rotate-180' : ''"></i>
                    </button>
                    <div x-show="expanded" x-transition class="ml-4 mt-2 space-y-1">
                        <button @click="openModal('gastos'); formData.tipo_gasto = 'combustible'" :class="currentSection === 'combustible' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-gas-pump mr-3 text-xs"></i>
                            Combustible
                        </button>
                        <button @click="openModal('gastos'); formData.tipo_gasto = 'seguro'" :class="currentSection === 'seguro' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-shield-alt mr-3 text-xs"></i>
                            Seguro
                        </button>
                        <button @click="openModal('gastos'); formData.tipo_gasto = 'compra-vehiculo'" :class="currentSection === 'compra-vehiculo' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-shopping-cart mr-3 text-xs"></i>
                            Compra de vehículo
                        </button>
                        <button @click="openModal('gastos'); formData.tipo_gasto = 'pago-tasas'" :class="currentSection === 'pago-tasas' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-file-invoice-dollar mr-3 text-xs"></i>
                            Pago de tasas
                        </button>
                        <button @click="openModal('gastos'); formData.tipo_gasto = 'parking'" :class="currentSection === 'parking' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-parking mr-3 text-xs"></i>
                            Parking
                        </button>
                        <button @click="openModal('gastos'); formData.tipo_gasto = 'teletac'" :class="currentSection === 'teletac' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-road mr-3 text-xs"></i>
                            Teletac
                        </button>
                        <button @click="openModal('gastos'); formData.tipo_gasto = 'lavado-coche'" :class="currentSection === 'lavado-coche' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-shower mr-3 text-xs"></i>
                            Lavado del coche
                        </button>
                        <button @click="openModal('gastos'); formData.tipo_gasto = 'itv'" :class="currentSection === 'itv' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-clipboard-check mr-3 text-xs"></i>
                            ITV
                        </button>
                        <button @click="openModal('gastos'); formData.tipo_gasto = 'taller'" :class="currentSection === 'taller' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-wrench mr-3 text-xs"></i>
                            Taller
                        </button>
                        <button @click="openModal('gastos'); formData.tipo_gasto = 'otros'" :class="currentSection === 'otros-gastos' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-ellipsis-h mr-3 text-xs"></i>
                            Otros gastos
                        </button>
                    </div>
                </div>
                
                <!-- Ingresos -->
                <div x-data="{ expanded: false }">
                    <button @click="expanded = !expanded" 
                            class="w-full flex items-center justify-between px-4 py-3 text-gray-300 hover:bg-gray-800 rounded-lg transition">
                        <div class="flex items-center">
                            <i class="fas fa-plus-circle mr-3"></i>
                            Ingresos
                        </div>
                        <i class="fas fa-chevron-down transform transition-transform" :class="expanded ? 'rotate-180' : ''"></i>
                    </button>
                    <div x-show="expanded" x-transition class="ml-4 mt-2 space-y-1">
                        <button @click="openModal('ingresos-apps')" :class="currentSection === 'ingresos-apps' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-mobile-alt mr-3 text-xs"></i>
                            Apps (Uber, Bolt, Cabify)
                        </button>
                        <button @click="openModal('ingresos-tpv')" :class="currentSection === 'ingresos-tpv' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-credit-card mr-3 text-xs"></i>
                            Ingresos por TPV
                        </button>
                        <button @click="openModal('ingresos-efectivo')" :class="currentSection === 'ingresos-efectivo' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-money-bill-wave mr-3 text-xs"></i>
                            Ingresos con efectivo
                        </button>
                        <button @click="openModal('facturacion-empresas')" :class="currentSection === 'facturacion-empresas' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-building mr-3 text-xs"></i>
                            Facturación a empresas
                        </button>
                        <button @click="openModal('transferencia-bancaria')" :class="currentSection === 'transferencia-bancaria' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-university mr-3 text-xs"></i>
                            Transferencia bancaria
                        </button>
                    </div>
                </div>
                
                <!-- DGT -->
                <div x-data="{ expanded: false }">
                    <button @click="expanded = !expanded" 
                            class="w-full flex items-center justify-between px-4 py-3 text-gray-300 hover:bg-gray-800 rounded-lg transition">
                        <div class="flex items-center">
                            <i class="fas fa-car-alt mr-3"></i>
                            DGT
                        </div>
                        <i class="fas fa-chevron-down transform transition-transform" :class="expanded ? 'rotate-180' : ''"></i>
                    </button>
                    <div x-show="expanded" x-transition class="ml-4 mt-2 space-y-1">
                        <button @click="openModal('matriculacion-vehiculos')" :class="currentSection === 'matriculacion-vehiculos' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-id-card mr-3 text-xs"></i>
                            Matriculación de vehículos
                        </button>
                        <button @click="openModal('transferencia-bajas')" :class="currentSection === 'transferencia-bajas' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-exchange-alt mr-3 text-xs"></i>
                            Transferencia y bajas
                        </button>
                        <button @click="openModal('pliegos-descargo')" :class="currentSection === 'pliegos-descargo' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-file-alt mr-3 text-xs"></i>
                            Pliegos de descargo
                        </button>
                        <button @click="openModal('reformas-vehiculos')" :class="currentSection === 'reformas-vehiculos' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-tools mr-3 text-xs"></i>
                            Reformas de vehículos
                        </button>
                        <button @click="openModal('duplicados-permiso')" :class="currentSection === 'duplicados-permiso' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-copy mr-3 text-xs"></i>
                            Duplicados permiso
                        </button>
                    </div>
                </div>
                
                <!-- Asistente IA -->
                <div x-data="{ expanded: false }">
                    <button @click="expanded = !expanded" 
                            class="w-full flex items-center justify-between px-4 py-3 text-gray-300 hover:bg-gray-800 rounded-lg transition">
                        <div class="flex items-center">
                            <i class="fas fa-robot mr-3"></i>
                            Asistente IA
                        </div>
                        <i class="fas fa-chevron-down transform transition-transform" :class="expanded ? 'rotate-180' : ''"></i>
                    </button>
                    <div x-show="expanded" x-transition class="ml-4 mt-2 space-y-1">
                        <button @click="currentSection = 'responder-preguntas'" :class="currentSection === 'responder-preguntas' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-comments mr-3 text-xs"></i>
                            Responder preguntas
                        </button>
                        <button @click="currentSection = 'automatizaciones'" :class="currentSection === 'automatizaciones' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-cogs mr-3 text-xs"></i>
                            Automatizaciones
                        </button>
                        <button @click="openModal('asistente-ia')" :class="currentSection === 'recordatorios' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-800'"
                                class="w-full flex items-center px-4 py-2 text-left rounded-lg transition text-sm">
                            <i class="fas fa-bell mr-3 text-xs"></i>
                            Recordatorios
                        </button>
                    </div>
                </div>
            </div>
        </nav>
        
        <div class="flex-shrink-0 p-4 border-t border-gray-700 mt-auto">
            <a href="/logout" class="flex items-center text-gray-400 hover:text-red-400 transition">
                <i class="fas fa-sign-out-alt mr-3"></i>
                Cerrar Sesión
            </a>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="flex-1 overflow-y-auto">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b px-6 py-4">
            <div class="flex justify-between items-center">
                <h2 class="text-2xl font-bold text-gray-800" x-text="getSectionTitle()"></h2>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <i class="fas fa-bell text-gray-400 text-xl"></i>
                        <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center">3</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <img src="https://via.placeholder.com/32" alt="User" class="w-8 h-8 rounded-full">
                        <span class="text-gray-700">Usuario</span>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Content -->
        <main class="p-6">
            <!-- Inicio -->
            <div x-show="currentSection === 'inicio'" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-blue-100 text-blue-600">
                                <i class="fas fa-car text-xl"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-gray-500 text-sm">Vehículos Activos</p>
                                <p class="text-2xl font-semibold">5</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-green-100 text-green-600">
                                <i class="fas fa-euro-sign text-xl"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-gray-500 text-sm">Ingresos del Mes</p>
                                <p class="text-2xl font-semibold">€12,450</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-yellow-100 text-yellow-600">
                                <i class="fas fa-gas-pump text-xl"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-gray-500 text-sm">Gastos del Mes</p>
                                <p class="text-2xl font-semibold">€3,200</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-purple-100 text-purple-600">
                                <i class="fas fa-users text-xl"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-gray-500 text-sm">Empleados</p>
                                <p class="text-2xl font-semibold">8</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h3 class="text-lg font-semibold mb-4">Ingresos vs Gastos</h3>
                        <canvas id="incomeChart" width="400" height="200"></canvas>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h3 class="text-lg font-semibold mb-4">Tareas Pendientes</h3>
                        <div class="space-y-3">
                            <div class="flex items-center p-3 bg-yellow-50 rounded-lg">
                                <i class="fas fa-exclamation-triangle text-yellow-500 mr-3"></i>
                                <div>
                                    <p class="font-medium">Renovar licencia VTC</p>
                                    <p class="text-sm text-gray-500">Vence en 15 días</p>
                                </div>
                            </div>
                            <div class="flex items-center p-3 bg-red-50 rounded-lg">
                                <i class="fas fa-file-invoice text-red-500 mr-3"></i>
                                <div>
                                    <p class="font-medium">Presentar modelo 303</p>
                                    <p class="text-sm text-gray-500">Vence mañana</p>
                                </div>
                            </div>
                            <div class="flex items-center p-3 bg-blue-50 rounded-lg">
                                <i class="fas fa-money-check text-blue-500 mr-3"></i>
                                <div>
                                    <p class="font-medium">Generar nóminas</p>
                                    <p class="text-sm text-gray-500">Pendiente del mes</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Empresa -->
            <div x-show="currentSection === 'empresa'" class="space-y-6">
                <!-- Header con estadísticas -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="bg-gradient-to-r from-blue-500 to-blue-600 p-6 rounded-xl text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-blue-100 text-sm">Empresas Activas</p>
                                <p class="text-2xl font-bold">3</p>
                            </div>
                            <i class="fas fa-building text-3xl text-blue-200"></i>
                        </div>
                    </div>
                    <div class="bg-gradient-to-r from-green-500 to-green-600 p-6 rounded-xl text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-green-100 text-sm">Autónomos</p>
                                <p class="text-2xl font-bold">12</p>
                            </div>
                            <i class="fas fa-user-tie text-3xl text-green-200"></i>
                        </div>
                    </div>
                    <div class="bg-gradient-to-r from-purple-500 to-purple-600 p-6 rounded-xl text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-purple-100 text-sm">Facturación Mensual</p>
                                <p class="text-2xl font-bold">€45.2K</p>
                            </div>
                            <i class="fas fa-euro-sign text-3xl text-purple-200"></i>
                        </div>
                    </div>
                    <div class="bg-gradient-to-r from-orange-500 to-orange-600 p-6 rounded-xl text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-orange-100 text-sm">Trámites Pendientes</p>
                                <p class="text-2xl font-bold">7</p>
                            </div>
                            <i class="fas fa-clipboard-check text-3xl text-orange-200"></i>
                        </div>
                    </div>
                </div>

                <!-- Tabs para diferentes tipos -->
                <div class="bg-white rounded-lg shadow">
                    <div class="border-b border-gray-200">
                        <nav class="flex space-x-8 px-6" x-data="{ activeTab: 'empresas' }">
                            <button @click="activeTab = 'empresas'" 
                                    :class="activeTab === 'empresas' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'"
                                    class="py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap">
                                <i class="fas fa-building mr-2"></i>Empresas
                            </button>
                            <button @click="activeTab = 'autonomos'" 
                                    :class="activeTab === 'autonomos' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'"
                                    class="py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap">
                                <i class="fas fa-user-tie mr-2"></i>Autónomos
                            </button>
                            <button @click="activeTab = 'configuracion'" 
                                    :class="activeTab === 'configuracion' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'"
                                    class="py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap">
                                <i class="fas fa-cog mr-2"></i>Configuración Fiscal
                            </button>
                        </nav>
                    </div>

                    <!-- Contenido de Empresas -->
                    <div x-show="activeTab === 'empresas'" class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-semibold text-gray-900">Gestión de Empresas</h3>
                            <button @click="showEmpresaModal = true" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">
                                <i class="fas fa-plus mr-2"></i>Nueva Empresa
                            </button>
                        </div>

                        <!-- Lista de empresas -->
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Empresa</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">CIF</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sector</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estado</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Facturación</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                                    <i class="fas fa-building text-blue-600"></i>
                                                </div>
                                                <div class="ml-4">
                                                    <div class="text-sm font-medium text-gray-900">TaxiCorp Madrid S.L.</div>
                                                    <div class="text-sm text-gray-500">Calle Mayor, 123</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">B12345678</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Transporte</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Activa</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">€25,400/mes</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button class="text-blue-600 hover:text-blue-900 mr-3">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="text-green-600 hover:text-green-900 mr-3">
                                                <i class="fas fa-file-invoice"></i>
                                            </button>
                                            <button class="text-gray-600 hover:text-gray-900">
                                                <i class="fas fa-ellipsis-h"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Contenido de Autónomos -->
                    <div x-show="activeTab === 'autonomos'" class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-semibold text-gray-900">Gestión de Autónomos</h3>
                            <button @click="showAutonomoModal = true" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition">
                                <i class="fas fa-plus mr-2"></i>Nuevo Autónomo
                            </button>
                        </div>

                        <!-- Grid de autónomos -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div class="bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                                        <i class="fas fa-user text-green-600 text-xl"></i>
                                    </div>
                                    <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Activo</span>
                                </div>
                                <h4 class="text-lg font-semibold text-gray-900 mb-2">Juan Pérez García</h4>
                                <p class="text-sm text-gray-500 mb-3">DNI: 12345678A</p>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Actividad:</span>
                                        <span class="font-medium">Conductor VTC</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">CNAE:</span>
                                        <span class="font-medium">4932</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Régimen:</span>
                                        <span class="font-medium">RETA</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Facturación:</span>
                                        <span class="font-medium text-green-600">€3,200/mes</span>
                                    </div>
                                </div>
                                <div class="mt-4 flex space-x-2">
                                    <button class="flex-1 bg-blue-50 text-blue-600 px-3 py-2 rounded-lg text-sm font-medium hover:bg-blue-100 transition">
                                        <i class="fas fa-edit mr-1"></i>Editar
                                    </button>
                                    <button class="flex-1 bg-green-50 text-green-600 px-3 py-2 rounded-lg text-sm font-medium hover:bg-green-100 transition">
                                        <i class="fas fa-file-invoice mr-1"></i>Facturas
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Contenido de Configuración Fiscal -->
                    <div x-show="activeTab === 'configuracion'" class="p-6">
                        <h3 class="text-xl font-semibold text-gray-900 mb-6">Configuración Fiscal</h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <!-- Configuración de IVA -->
                            <div class="bg-gray-50 rounded-lg p-6">
                                <h4 class="text-lg font-semibold text-gray-900 mb-4">
                                    <i class="fas fa-percentage text-blue-600 mr-2"></i>Configuración de IVA
                                </h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de IVA por defecto</label>
                                        <select class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                            <option>21% - General</option>
                                            <option>10% - Reducido</option>
                                            <option>4% - Superreducido</option>
                                            <option>0% - Exento</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Régimen de IVA</label>
                                        <select class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                            <option>General</option>
                                            <option>Simplificado</option>
                                            <option>Recargo de equivalencia</option>
                                            <option>Criterio de caja</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Configuración de IRPF -->
                            <div class="bg-gray-50 rounded-lg p-6">
                                <h4 class="text-lg font-semibold text-gray-900 mb-4">
                                    <i class="fas fa-calculator text-green-600 mr-2"></i>Configuración de IRPF
                                </h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de retención</label>
                                        <select class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                            <option>15% - Actividades profesionales</option>
                                            <option>7% - Actividades empresariales</option>
                                            <option>21% - Actividades artísticas</option>
                                            <option>2% - Actividades agrícolas</option>
                                        </select>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded">
                                        <label class="ml-2 text-sm text-gray-700">Aplicar retención automáticamente</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vehículos -->
            <div x-show="currentSection === 'vehiculos'" class="space-y-6">
                <!-- Header con estadísticas de vehículos -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="bg-gradient-to-r from-blue-500 to-blue-600 p-6 rounded-xl text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-blue-100 text-sm">Total Vehículos</p>
                                <p class="text-2xl font-bold">12</p>
                            </div>
                            <i class="fas fa-car text-3xl text-blue-200"></i>
                        </div>
                    </div>
                    <div class="bg-gradient-to-r from-green-500 to-green-600 p-6 rounded-xl text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-green-100 text-sm">Activos</p>
                                <p class="text-2xl font-bold">10</p>
                            </div>
                            <i class="fas fa-check-circle text-3xl text-green-200"></i>
                        </div>
                    </div>
                    <div class="bg-gradient-to-r from-yellow-500 to-yellow-600 p-6 rounded-xl text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-yellow-100 text-sm">Mantenimiento</p>
                                <p class="text-2xl font-bold">2</p>
                            </div>
                            <i class="fas fa-wrench text-3xl text-yellow-200"></i>
                        </div>
                    </div>
                    <div class="bg-gradient-to-r from-red-500 to-red-600 p-6 rounded-xl text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-red-100 text-sm">Revisiones Pendientes</p>
                                <p class="text-2xl font-bold">3</p>
                            </div>
                            <i class="fas fa-clipboard-check text-3xl text-red-200"></i>
                        </div>
                    </div>
                </div>

                <!-- Gestión de vehículos -->
                <div class="bg-white rounded-lg shadow">
                    <div class="px-6 py-4 border-b border-gray-200">
                        <div class="flex justify-between items-center">
                            <h3 class="text-xl font-semibold text-gray-900">Flota de Vehículos</h3>
                            <div class="flex space-x-3">
                                <button class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition">
                                    <i class="fas fa-plus mr-2"></i>Nuevo Vehículo
                                </button>
                                <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">
                                    <i class="fas fa-download mr-2"></i>Exportar
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="p-6">
                        <!-- Filtros -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Filtrar por estado</label>
                                <select class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                    <option>Todos</option>
                                    <option>Activo</option>
                                    <option>Mantenimiento</option>
                                    <option>Fuera de servicio</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de vehículo</label>
                                <select class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                    <option>Todos</option>
                                    <option>Taxi</option>
                                    <option>VTC</option>
                                    <option>Minibús</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Conductor asignado</label>
                                <select class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                    <option>Todos</option>
                                    <option>Juan Pérez</option>
                                    <option>María García</option>
                                    <option>Sin asignar</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Buscar</label>
                                <input type="text" placeholder="Matrícula, modelo..." class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            </div>
                        </div>

                        <!-- Lista de vehículos -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                            <!-- Vehículo 1 -->
                            <div class="border border-gray-200 rounded-lg p-6 hover:shadow-md transition">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                            <i class="fas fa-taxi text-blue-600 text-xl"></i>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-gray-900">Toyota Prius</h4>
                                            <p class="text-sm text-gray-500">1234-ABC</p>
                                        </div>
                                    </div>
                                    <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Activo</span>
                                </div>
                                
                                <div class="space-y-3 text-sm">
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Conductor:</span>
                                        <span class="font-medium">Juan Pérez</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Tipo:</span>
                                        <span class="font-medium">VTC</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Año:</span>
                                        <span class="font-medium">2020</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">KM:</span>
                                        <span class="font-medium">125,430</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Seg. vence:</span>
                                        <span class="font-medium text-yellow-600">15 Mar 2024</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">ITV vence:</span>
                                        <span class="font-medium text-green-600">22 Jul 2024</span>
                                    </div>
                                </div>

                                <div class="mt-4 pt-4 border-t border-gray-200">
                                    <div class="flex space-x-2">
                                        <button class="flex-1 bg-blue-50 text-blue-600 px-3 py-2 rounded-lg text-sm font-medium hover:bg-blue-100 transition">
                                            <i class="fas fa-edit mr-1"></i>Editar
                                        </button>
                                        <button class="flex-1 bg-green-50 text-green-600 px-3 py-2 rounded-lg text-sm font-medium hover:bg-green-100 transition">
                                            <i class="fas fa-wrench mr-1"></i>Mantenimiento
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Vehículo 2 -->
                            <div class="border border-gray-200 rounded-lg p-6 hover:shadow-md transition">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                                            <i class="fas fa-taxi text-yellow-600 text-xl"></i>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-gray-900">Seat Leon</h4>
                                            <p class="text-sm text-gray-500">5678-DEF</p>
                                        </div>
                                    </div>
                                    <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">Mantenimiento</span>
                                </div>
                                
                                <div class="space-y-3 text-sm">
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Conductor:</span>
                                        <span class="font-medium">María García</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Tipo:</span>
                                        <span class="font-medium">Taxi</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Año:</span>
                                        <span class="font-medium">2019</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">KM:</span>
                                        <span class="font-medium">89,560</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Seg. vence:</span>
                                        <span class="font-medium text-green-600">08 May 2024</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">ITV vence:</span>
                                        <span class="font-medium text-red-600">05 Feb 2024</span>
                                    </div>
                                </div>

                                <div class="mt-4 pt-4 border-t border-gray-200">
                                    <div class="flex space-x-2">
                                        <button class="flex-1 bg-blue-50 text-blue-600 px-3 py-2 rounded-lg text-sm font-medium hover:bg-blue-100 transition">
                                            <i class="fas fa-edit mr-1"></i>Editar
                                        </button>
                                        <button class="flex-1 bg-green-50 text-green-600 px-3 py-2 rounded-lg text-sm font-medium hover:bg-green-100 transition">
                                            <i class="fas fa-check mr-1"></i>Finalizar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Empleados -->
            <div x-show="currentSection === 'empleados'" class="space-y-6">
                <div class="bg-white p-6 rounded-lg shadow">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold">Lista de Empleados</h3>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                            <i class="fas fa-plus mr-2"></i>Añadir Empleado
                        </button>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nombre</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">DNI</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Puesto</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Salario</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estado</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">Juan Pérez</td>
                                    <td class="px-6 py-4 whitespace-nowrap">12345678A</td>
                                    <td class="px-6 py-4 whitespace-nowrap">Conductor</td>
                                    <td class="px-6 py-4 whitespace-nowrap">€1,500</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Activo</span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                                        <button class="text-blue-600 hover:text-blue-900 mr-3">Editar</button>
                                        <button class="text-red-600 hover:text-red-900">Eliminar</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Asistente IA -->
            <div x-show="currentSection === 'asistente-ia'" class="space-y-6">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-lg font-semibold mb-4">Asistente IA</h3>
                    <div class="bg-gray-50 p-4 rounded-lg mb-4 h-96 overflow-y-auto" id="chatMessages">
                        <div class="space-y-3">
                            <div class="bg-blue-100 p-3 rounded-lg">
                                <p class="text-sm"><strong>Asistente:</strong> ¡Hola! Soy tu asistente de gestoría. ¿En qué puedo ayudarte hoy?</p>
                            </div>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <input type="text" id="chatInput" placeholder="Escribe tu pregunta..." class="flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <button onclick="sendMessage()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="font-semibold mb-3">Automatizaciones Activas</h4>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between p-2 bg-green-50 rounded">
                                <span class="text-sm">Recordatorio de vencimientos</span>
                                <i class="fas fa-check-circle text-green-500"></i>
                            </div>
                            <div class="flex items-center justify-between p-2 bg-green-50 rounded">
                                <span class="text-sm">Generación de facturas</span>
                                <i class="fas fa-check-circle text-green-500"></i>
                            </div>
                            <div class="flex items-center justify-between p-2 bg-yellow-50 rounded">
                                <span class="text-sm">Análisis de gastos</span>
                                <i class="fas fa-clock text-yellow-500"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="font-semibold mb-3">Próximos Recordatorios</h4>
                        <div class="space-y-2">
                            <div class="p-2 bg-red-50 rounded">
                                <p class="text-sm font-medium">Modelo 303 - IVA</p>
                                <p class="text-xs text-gray-500">Vence: 20 Enero 2024</p>
                            </div>
                            <div class="p-2 bg-yellow-50 rounded">
                                <p class="text-sm font-medium">Renovar licencia</p>
                                <p class="text-xs text-gray-500">Vence: 15 Febrero 2024</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h4 class="font-semibold mb-3">Análisis IA Recientes</h4>
                        <div class="space-y-2">
                            <div class="p-2 bg-blue-50 rounded">
                                <p class="text-sm">Optimización de rutas detectada</p>
                                <p class="text-xs text-gray-500">Ahorro potencial: €200/mes</p>
                            </div>
                            <div class="p-2 bg-purple-50 rounded">
                                <p class="text-sm">Patrón de gastos anómalo</p>
                                <p class="text-xs text-gray-500">Revisión recomendada</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Indicador de carga -->
            <div x-show="loading" class="bg-white p-6 rounded-lg shadow">
                <div class="text-center py-12">
                    <i class="fas fa-spinner fa-spin text-4xl text-blue-500 mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-600 mb-2">Cargando...</h3>
                    <p class="text-gray-500">Obteniendo datos de la sección.</p>
                </div>
            </div>
            
            <!-- Otras secciones se muestran con contenido dinámico -->
            <div x-show="!loading && !['inicio', 'empresa', 'empleados', 'asistente-ia'].includes(currentSection)" class="bg-white p-6 rounded-lg shadow">
                <div x-show="sectionData[currentSection]?.error" class="text-center py-12">
                    <i class="fas fa-exclamation-triangle text-6xl text-red-300 mb-4"></i>
                    <h3 class="text-xl font-semibold text-red-600 mb-2">Error al cargar datos</h3>
                    <p class="text-gray-500" x-text="sectionData[currentSection]?.error"></p>
                </div>
                
                <div x-show="!sectionData[currentSection]?.error" class="space-y-6">
                    <!-- Formulario genérico para capturar datos -->
                    <div class="border-b border-gray-200 pb-4">
                        <h3 class="text-xl font-semibold text-gray-900" x-text="getSectionTitle()"></h3>
                        <p class="text-gray-600 mt-2">Gestiona esta funcionalidad desde aquí.</p>
                    </div>
                    
                    <!-- Contenido dinámico basado en los datos de la API -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-gray-900 mb-3">Datos Disponibles</h4>
                                <pre class="text-sm text-gray-600 whitespace-pre-wrap" x-text="JSON.stringify(sectionData[currentSection], null, 2)"></pre>
                            </div>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-gray-900 mb-3">Acciones Disponibles</h4>
                                <div class="space-y-2">
                                    <button @click="alert('Función en desarrollo')" class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                                        <i class="fas fa-plus mr-2"></i>Agregar Nuevo
                                    </button>
                                    <button @click="alert('Función en desarrollo')" class="w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                                        <i class="fas fa-edit mr-2"></i>Editar Existente
                                    </button>
                                    <button @click="loadSection(currentSection)" class="w-full bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition">
                                        <i class="fas fa-sync mr-2"></i>Recargar Datos
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Modales para todas las funcionalidades -->
    
    <!-- Modal Altas de Empleados -->
    <div x-show="showModal === 'altas-empleados'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Alta de Empleado</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('altas-empleados')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nombre</label>
                        <input type="text" x-model="formData.nombre" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Apellidos</label>
                        <input type="text" x-model="formData.apellidos" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">DNI/NIE</label>
                        <input type="text" x-model="formData.dni" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Seguridad Social</label>
                        <input type="text" x-model="formData.nss" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Nacimiento</label>
                        <input type="date" x-model="formData.fecha_nacimiento" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Puesto de Trabajo</label>
                        <select x-model="formData.puesto" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar puesto</option>
                            <option value="conductor">Conductor</option>
                            <option value="mecanico">Mecánico</option>
                            <option value="administrativo">Administrativo</option>
                            <option value="supervisor">Supervisor</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Salario Bruto</label>
                        <input type="number" x-model="formData.salario" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Alta</label>
                        <input type="date" x-model="formData.fecha_alta" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Dar de Alta</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Nóminas -->
    <div x-show="showModal === 'nominas'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Generar Nómina</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('nominas')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Empleado</label>
                        <select x-model="formData.empleado_id" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar empleado</option>
                            <option value="1">Juan Pérez García</option>
                            <option value="2">María García López</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Período</label>
                        <input type="month" x-model="formData.periodo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Días Trabajados</label>
                        <input type="number" x-model="formData.dias_trabajados" min="1" max="31" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Horas Extras</label>
                        <input type="number" x-model="formData.horas_extras" min="0" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Complementos</label>
                        <input type="number" x-model="formData.complementos" min="0" step="0.01" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Deducciones</label>
                        <input type="number" x-model="formData.deducciones" min="0" step="0.01" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Generar Nómina</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Bajas de Empleados -->
    <div x-show="showModal === 'bajas-empleados'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Baja de Empleado</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('bajas-empleados')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Empleado a dar de baja</label>
                        <select x-model="formData.empleado_id" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar empleado</option>
                            <option value="1">Juan Pérez García - DNI: 12345678A</option>
                            <option value="2">María García López - DNI: 87654321B</option>
                            <option value="3">Carlos Ruiz Martín - DNI: 11223344C</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Baja</label>
                        <input type="date" x-model="formData.fecha_baja" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Baja</label>
                        <select x-model="formData.tipo_baja" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="voluntaria">Baja Voluntaria</option>
                            <option value="despido">Despido Disciplinario</option>
                            <option value="finalizacion_contrato">Finalización de Contrato</option>
                            <option value="jubilacion">Jubilación</option>
                            <option value="despido_objetivo">Despido Objetivo</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Causa Específica</label>
                        <select x-model="formData.causa_baja" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar causa</option>
                            <option value="51">51 - Fin de contrato temporal</option>
                            <option value="52">52 - Fin de obra o servicio</option>
                            <option value="53">53 - Despido disciplinario</option>
                            <option value="54">54 - Despido objetivo</option>
                            <option value="56">56 - Dimisión</option>
                            <option value="59">59 - Jubilación</option>
                            <option value="61">61 - Muerte</option>
                            <option value="63">63 - Incapacidad permanente</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha último día trabajado</label>
                        <input type="date" x-model="formData.ultimo_dia_trabajado" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Indemnización (€)</label>
                        <input type="number" x-model="formData.indemnizacion" min="0" step="0.01" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Observaciones</label>
                    <textarea x-model="formData.observaciones" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500" placeholder="Detalles adicionales sobre la baja..."></textarea>
                </div>
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-yellow-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-yellow-700">
                                <strong>Importante:</strong> La baja del empleado generará automáticamente:
                            </p>
                            <ul class="text-sm text-yellow-700 list-disc list-inside mt-2">
                                <li>Comunicación a la Seguridad Social</li>
                                <li>Finiquito correspondiente</li>
                                <li>Certificado de empresa</li>
                                <li>Devolución de documentos (si procede)</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">Procesar Baja</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Modelos AEAT -->
    <div x-show="showModal === 'modelos-aeat'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Presentar Modelo AEAT</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('modelos-aeat')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Modelo</label>
                        <select x-model="formData.modelo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar modelo</option>
                            <option value="303">Modelo 303 - IVA</option>
                            <option value="130">Modelo 130 - IRPF</option>
                            <option value="390">Modelo 390 - Resumen IVA</option>
                            <option value="100">Modelo 100 - IRPF Anual</option>
                            <option value="347">Modelo 347 - Operaciones con terceros</option>
                            <option value="111">Modelo 111 - Retenciones</option>
                            <option value="115">Modelo 115 - Retenciones arrendamientos</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Período</label>
                        <select x-model="formData.periodo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar período</option>
                            <option value="1T">1º Trimestre</option>
                            <option value="2T">2º Trimestre</option>
                            <option value="3T">3º Trimestre</option>
                            <option value="4T">4º Trimestre</option>
                            <option value="01">Enero</option>
                            <option value="02">Febrero</option>
                            <option value="03">Marzo</option>
                            <option value="04">Abril</option>
                            <option value="05">Mayo</option>
                            <option value="06">Junio</option>
                            <option value="07">Julio</option>
                            <option value="08">Agosto</option>
                            <option value="09">Septiembre</option>
                            <option value="10">Octubre</option>
                            <option value="11">Noviembre</option>
                            <option value="12">Diciembre</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ejercicio</label>
                        <input type="number" x-model="formData.ejercicio" min="2020" max="2030" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">NIF/CIF</label>
                        <input type="text" x-model="formData.nif" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div class="space-y-4" x-show="formData.modelo === '303'">
                    <h4 class="font-medium text-gray-900">Datos específicos Modelo 303</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">IVA Devengado</label>
                            <input type="number" x-model="formData.iva_devengado" step="0.01" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">IVA Deducible</label>
                            <input type="number" x-model="formData.iva_deducible" step="0.01" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Presentar Modelo</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Libro de Ingresos -->
    <div x-show="showModal === 'libro-ingresos'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Registrar Ingreso</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('libro-ingresos')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha</label>
                        <input type="date" x-model="formData.fecha" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Factura</label>
                        <input type="text" x-model="formData.numero_factura" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Cliente/Descripción</label>
                        <input type="text" x-model="formData.cliente" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Base Imponible</label>
                        <input type="number" x-model="formData.base_imponible" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo IVA</label>
                        <select x-model="formData.tipo_iva" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="21">21% - General</option>
                            <option value="10">10% - Reducido</option>
                            <option value="4">4% - Superreducido</option>
                            <option value="0">0% - Exento</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Cuota IVA</label>
                        <input type="number" x-model="formData.cuota_iva" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Método de Pago</label>
                        <select x-model="formData.metodo_pago" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar método</option>
                            <option value="efectivo">Efectivo</option>
                            <option value="tarjeta">Tarjeta</option>
                            <option value="transferencia">Transferencia</option>
                            <option value="app">App (Uber, Cabify, etc.)</option>
                        </select>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Registrar Ingreso</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal VTC - Rehabilitar Autorización -->
    <div x-show="showModal === 'rehabilitar-autorizacion'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Rehabilitar Autorización VTC</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('rehabilitar-autorizacion')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Autorización</label>
                        <input type="text" x-model="formData.numero_autorizacion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Caducidad</label>
                        <input type="date" x-model="formData.fecha_caducidad" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">NIF Titular</label>
                        <input type="text" x-model="formData.nif_titular" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Motivo de Rehabilitación</label>
                        <select x-model="formData.motivo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar motivo</option>
                            <option value="no_renovacion">No renovación en plazo</option>
                            <option value="suspension">Fin de suspensión</option>
                            <option value="otros">Otros motivos</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Documentación</label>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                        <i class="fas fa-cloud-upload-alt text-gray-400 text-3xl mb-2"></i>
                        <p class="text-gray-500">Arrastra aquí los documentos o haz clic para seleccionar</p>
                        <input type="file" multiple class="hidden">
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Solicitar Rehabilitación</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Gastos -->
    <div x-show="showModal === 'gastos'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Registrar Gasto</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('gastos')" class="p-6 space-y-6">
                <!-- Selector de Tipo de Gasto -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Gasto</label>
                    <select x-model="formData.tipo_gasto" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        <option value="">Seleccionar tipo de gasto</option>
                        <option value="combustible">Combustible</option>
                        <option value="seguro">Seguro</option>
                        <option value="compra-vehiculo">Compra de vehículo</option>
                        <option value="pago-tasas">Pago de tasas</option>
                        <option value="parking">Parking</option>
                        <option value="teletac">Teletac</option>
                        <option value="lavado-coche">Lavado del coche</option>
                        <option value="itv">ITV</option>
                        <option value="taller">Taller</option>
                        <option value="otros">Otros gastos</option>
                    </select>
                </div>

                <!-- Campos comunes -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha</label>
                        <input type="date" x-model="formData.fecha" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Importe Total</label>
                        <input type="number" x-model="formData.importe" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Proveedor/Establecimiento</label>
                        <input type="text" x-model="formData.proveedor" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Vehículo</label>
                        <select x-model="formData.vehiculo" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar vehículo</option>
                            <option value="1234-ABC">Toyota Prius - 1234-ABC</option>
                            <option value="5678-DEF">Seat Leon - 5678-DEF</option>
                        </select>
                    </div>
                </div>

                <!-- Campos específicos para Combustible -->
                <div x-show="formData.tipo_gasto === 'combustible'" class="border-t border-gray-200 pt-4">
                    <h4 class="text-lg font-medium text-gray-900 mb-4">Detalles del Combustible</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Combustible</label>
                            <select x-model="formData.tipo_combustible" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">Seleccionar</option>
                                <option value="gasolina_95">Gasolina 95</option>
                                <option value="gasolina_98">Gasolina 98</option>
                                <option value="diesel">Diésel</option>
                                <option value="glp">GLP</option>
                                <option value="electricidad">Electricidad</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Litros/kWh</label>
                            <input type="number" x-model="formData.cantidad" step="0.01" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Precio por litro/kWh</label>
                            <input type="number" x-model="formData.precio_unitario" step="0.001" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                    </div>
                </div>

                <!-- Campos específicos para Seguro -->
                <div x-show="formData.tipo_gasto === 'seguro'" class="border-t border-gray-200 pt-4">
                    <h4 class="text-lg font-medium text-gray-900 mb-4">Detalles del Seguro</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Seguro</label>
                            <select x-model="formData.tipo_seguro" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">Seleccionar</option>
                                <option value="vehiculo">Seguro de vehículo</option>
                                <option value="responsabilidad_civil">Responsabilidad civil</option>
                                <option value="vida">Seguro de vida</option>
                                <option value="accidentes">Seguro de accidentes</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Período de Cobertura</label>
                            <select x-model="formData.periodo_seguro" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">Seleccionar</option>
                                <option value="mensual">Mensual</option>
                                <option value="trimestral">Trimestral</option>
                                <option value="semestral">Semestral</option>
                                <option value="anual">Anual</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Número de Póliza</label>
                            <input type="text" x-model="formData.numero_poliza" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Vencimiento</label>
                            <input type="date" x-model="formData.fecha_vencimiento" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                    </div>
                </div>

                <!-- Campos específicos para Compra de Vehículo -->
                <div x-show="formData.tipo_gasto === 'compra-vehiculo'" class="border-t border-gray-200 pt-4">
                    <h4 class="text-lg font-medium text-gray-900 mb-4">Detalles de la Compra</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Marca del Vehículo</label>
                            <input type="text" x-model="formData.marca_vehiculo" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Modelo</label>
                            <input type="text" x-model="formData.modelo_vehiculo" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Año</label>
                            <input type="number" x-model="formData.año_vehiculo" min="1990" max="2024" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Kilómetros</label>
                            <input type="number" x-model="formData.kilometros" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Compra</label>
                            <select x-model="formData.tipo_compra" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">Seleccionar</option>
                                <option value="nuevo">Vehículo nuevo</option>
                                <option value="usado">Vehículo usado</option>
                                <option value="km0">Vehículo km 0</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Matrícula</label>
                            <input type="text" x-model="formData.matricula_nueva" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                    </div>
                </div>

                <!-- Campos específicos para Pago de Tasas -->
                <div x-show="formData.tipo_gasto === 'pago-tasas'" class="border-t border-gray-200 pt-4">
                    <h4 class="text-lg font-medium text-gray-900 mb-4">Detalles de las Tasas</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Tasa</label>
                            <select x-model="formData.tipo_tasa" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">Seleccionar</option>
                                <option value="municipales">Tasas municipales</option>
                                <option value="dgt">Tasas DGT</option>
                                <option value="hacienda">Tasas Hacienda</option>
                                <option value="autonomicas">Tasas autonómicas</option>
                                <option value="otras">Otras tasas</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Concepto</label>
                            <input type="text" x-model="formData.concepto_tasa" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Número de Expediente</label>
                            <input type="text" x-model="formData.numero_expediente" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Organismo</label>
                            <input type="text" x-model="formData.organismo" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                    </div>
                </div>

                <!-- Campos específicos para Parking -->
                <div x-show="formData.tipo_gasto === 'parking'" class="border-t border-gray-200 pt-4">
                    <h4 class="text-lg font-medium text-gray-900 mb-4">Detalles del Parking</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Parking</label>
                            <select x-model="formData.tipo_parking" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">Seleccionar</option>
                                <option value="publico">Parking público</option>
                                <option value="privado">Parking privado</option>
                                <option value="zona_azul">Zona azul</option>
                                <option value="aeropuerto">Aeropuerto</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Horas</label>
                            <input type="number" x-model="formData.horas_parking" step="0.5" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ubicación</label>
                            <input type="text" x-model="formData.ubicacion_parking" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                    </div>
                </div>

                <!-- Campos específicos para Teletac -->
                <div x-show="formData.tipo_gasto === 'teletac'" class="border-t border-gray-200 pt-4">
                    <h4 class="text-lg font-medium text-gray-900 mb-4">Detalles del Teletac</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Autopista/Peaje</label>
                            <input type="text" x-model="formData.autopista" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tramo</label>
                            <input type="text" x-model="formData.tramo" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Kilómetros</label>
                            <input type="number" x-model="formData.kilometros_peaje" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Número de Dispositivo</label>
                            <input type="text" x-model="formData.numero_teletac" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                    </div>
                </div>

                <!-- Campos específicos para Lavado -->
                <div x-show="formData.tipo_gasto === 'lavado-coche'" class="border-t border-gray-200 pt-4">
                    <h4 class="text-lg font-medium text-gray-900 mb-4">Detalles del Lavado</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Lavado</label>
                            <select x-model="formData.tipo_lavado" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">Seleccionar</option>
                                <option value="exterior">Lavado exterior</option>
                                <option value="completo">Lavado completo</option>
                                <option value="interior">Limpieza interior</option>
                                <option value="premium">Lavado premium</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Frecuencia</label>
                            <select x-model="formData.frecuencia_lavado" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">Seleccionar</option>
                                <option value="semanal">Semanal</option>
                                <option value="quincenal">Quincenal</option>
                                <option value="mensual">Mensual</option>
                                <option value="ocasional">Ocasional</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Campos específicos para ITV -->
                <div x-show="formData.tipo_gasto === 'itv'" class="border-t border-gray-200 pt-4">
                    <h4 class="text-lg font-medium text-gray-900 mb-4">Detalles de la ITV</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Resultado</label>
                            <select x-model="formData.resultado_itv" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">Seleccionar</option>
                                <option value="favorable">Favorable</option>
                                <option value="desfavorable">Desfavorable</option>
                                <option value="negativa">Negativa</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Próxima Revisión</label>
                            <input type="date" x-model="formData.proxima_itv" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Kilómetros en ITV</label>
                            <input type="number" x-model="formData.kilometros_itv" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Estación ITV</label>
                            <input type="text" x-model="formData.estacion_itv" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                    </div>
                </div>

                <!-- Campos específicos para Taller -->
                <div x-show="formData.tipo_gasto === 'taller'" class="border-t border-gray-200 pt-4">
                    <h4 class="text-lg font-medium text-gray-900 mb-4">Detalles del Taller</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Reparación</label>
                            <select x-model="formData.tipo_reparacion" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">Seleccionar</option>
                                <option value="mecanica">Mecánica</option>
                                <option value="chapa_pintura">Chapa y pintura</option>
                                <option value="neumaticos">Neumáticos</option>
                                <option value="revision">Revisión</option>
                                <option value="mantenimiento">Mantenimiento</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Garantía (meses)</label>
                            <input type="number" x-model="formData.garantia_meses" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Kilómetros Actuales</label>
                            <input type="number" x-model="formData.kilometros_actuales" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Próximo Mantenimiento (km)</label>
                            <input type="number" x-model="formData.proximo_mantenimiento" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Descripción de la Reparación</label>
                        <textarea x-model="formData.descripcion_reparacion" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2"></textarea>
                    </div>
                </div>

                <!-- Campos comunes finales -->
                <div class="border-t border-gray-200 pt-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Número de Factura/Ticket</label>
                            <input type="text" x-model="formData.numero_factura" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">IVA</label>
                            <select x-model="formData.iva" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                <option value="">Seleccionar IVA</option>
                                <option value="21">21%</option>
                                <option value="10">10%</option>
                                <option value="4">4%</option>
                                <option value="0">0%</option>
                            </select>
                        </div>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Observaciones</label>
                        <textarea x-model="formData.observaciones" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2" placeholder="Información adicional sobre el gasto..."></textarea>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">Registrar Gasto</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Asistente IA -->
    <div x-show="showModal === 'asistente-ia'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Asistente IA - Configuración</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold text-gray-900 mb-4">Configurar Recordatorios</h4>
                        <form @submit.prevent="submitForm('recordatorios')" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Recordatorio</label>
                                <select x-model="formData.tipo_recordatorio" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                    <option value="">Seleccionar tipo</option>
                                    <option value="seguro">Vencimiento Seguro</option>
                                    <option value="itv">Vencimiento ITV</option>
                                    <option value="autorizacion">Vencimiento Autorización</option>
                                    <option value="modelo_fiscal">Modelo Fiscal</option>
                                    <option value="mantenimiento">Mantenimiento Vehículo</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Días de Antelación</label>
                                <input type="number" x-model="formData.dias_antelacion" min="1" max="365" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Método de Notificación</label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" x-model="formData.notif_dashboard" class="mr-2">
                                        Dashboard
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" x-model="formData.notif_email" class="mr-2">
                                        Email
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" x-model="formData.notif_sms" class="mr-2">
                                        SMS
                                    </label>
                                </div>
                            </div>
                            <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700">
                                Configurar Recordatorio
                            </button>
                        </form>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold text-gray-900 mb-4">Automatizaciones</h4>
                        <div class="space-y-3">
                            <div class="border border-gray-200 rounded-lg p-4">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h5 class="font-medium">Generación automática de facturas</h5>
                                        <p class="text-sm text-gray-500">Crear facturas automáticamente al final del día</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" x-model="automatizaciones.facturas_auto">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="border border-gray-200 rounded-lg p-4">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h5 class="font-medium">Backup automático</h5>
                                        <p class="text-sm text-gray-500">Respaldo diario de datos</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" x-model="automatizaciones.backup_auto">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="border border-gray-200 rounded-lg p-4">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h5 class="font-medium">Análisis de gastos</h5>
                                        <p class="text-sm text-gray-500">Análisis semanal de patrones de gasto</p>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" x-model="automatizaciones.analisis_gastos">
                                        <span class="slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Contratos de Trabajo -->
    <div x-show="showModal === 'contratos-trabajo'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Crear Contrato de Trabajo</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('contratos-trabajo')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Empleado</label>
                        <select x-model="formData.empleado_id" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            <option value="">Seleccionar empleado</option>
                            <option value="1">Juan Pérez García</option>
                            <option value="2">María García López</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Contrato</label>
                        <select x-model="formData.tipo_contrato" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            <option value="">Seleccionar tipo</option>
                            <option value="indefinido">Indefinido</option>
                            <option value="temporal">Temporal</option>
                            <option value="obra_servicio">Obra y Servicio</option>
                            <option value="formacion">Formación</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Inicio</label>
                        <input type="date" x-model="formData.fecha_inicio" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Fin (si aplica)</label>
                        <input type="date" x-model="formData.fecha_fin" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Salario</label>
                        <input type="number" x-model="formData.salario" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Jornada</label>
                        <select x-model="formData.jornada" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            <option value="">Seleccionar jornada</option>
                            <option value="completa">Completa</option>
                            <option value="parcial">Parcial</option>
                        </select>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Crear Contrato</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Libro de Gastos -->
    <div x-show="showModal === 'libro-gastos'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Registrar Gasto</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('libro-gastos')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha</label>
                        <input type="date" x-model="formData.fecha" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Proveedor</label>
                        <input type="text" x-model="formData.proveedor" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Concepto</label>
                        <input type="text" x-model="formData.concepto" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Base Imponible</label>
                        <input type="number" x-model="formData.base_imponible" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo IVA</label>
                        <select x-model="formData.tipo_iva" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            <option value="">Seleccionar tipo</option>
                            <option value="21">21% - General</option>
                            <option value="10">10% - Reducido</option>
                            <option value="4">4% - Superreducido</option>
                            <option value="0">0% - Exento</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Cuota IVA</label>
                        <input type="number" x-model="formData.cuota_iva" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">Registrar Gasto</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Alta Autónomo/Empresa -->
    <div x-show="showModal === 'alta-autonomo-empresa'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Alta Autónomo/Empresa</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('alta-autonomo-empresa')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Alta</label>
                        <select x-model="formData.tipo_alta" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            <option value="">Seleccionar tipo</option>
                            <option value="autonomo">Autónomo</option>
                            <option value="empresa">Empresa</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">NIF/CIF</label>
                        <input type="text" x-model="formData.nif_cif" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nombre/Razón Social</label>
                        <input type="text" x-model="formData.nombre_razon" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Actividad Principal</label>
                        <input type="text" x-model="formData.actividad_principal" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">CNAE</label>
                        <input type="text" x-model="formData.cnae" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Inicio</label>
                        <input type="date" x-model="formData.fecha_inicio" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Procesar Alta</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Transmitir Autorización -->
    <div x-show="showModal === 'transmitir-autorizacion'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Transmitir Autorización VTC</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('transmitir-autorizacion')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Autorización</label>
                        <input type="text" x-model="formData.numero_autorizacion" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">NIF Titular Actual</label>
                        <input type="text" x-model="formData.nif_actual" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">NIF Nuevo Titular</label>
                        <input type="text" x-model="formData.nif_nuevo" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nombre Nuevo Titular</label>
                        <input type="text" x-model="formData.nombre_nuevo" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Transmisión</label>
                        <input type="date" x-model="formData.fecha_transmision" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Motivo</label>
                        <select x-model="formData.motivo" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            <option value="">Seleccionar motivo</option>
                            <option value="venta">Venta</option>
                            <option value="herencia">Herencia</option>
                            <option value="fusion">Fusión empresarial</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Transmitir Autorización</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Calendario de Vacaciones -->
    <div x-show="showModal === 'calendario-vacaciones'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Solicitar Vacaciones</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('calendario-vacaciones')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Empleado</label>
                        <select x-model="formData.empleado_id" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            <option value="">Seleccionar empleado</option>
                            <option value="1">Juan Pérez García</option>
                            <option value="2">María García López</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Solicitud</label>
                        <select x-model="formData.tipo_solicitud" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            <option value="">Seleccionar tipo</option>
                            <option value="vacaciones">Vacaciones</option>
                            <option value="permiso">Permiso</option>
                            <option value="baja_medica">Baja médica</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Inicio</label>
                        <input type="date" x-model="formData.fecha_inicio" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Fin</label>
                        <input type="date" x-model="formData.fecha_fin" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Observaciones</label>
                    <textarea x-model="formData.observaciones" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2"></textarea>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Solicitar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Enviar Nóminas -->
    <div x-show="showModal === 'enviar-nominas'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Enviar Nóminas Mensual</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('enviar-nominas')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Mes</label>
                        <input type="month" x-model="formData.mes" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Método de Envío</label>
                        <select x-model="formData.metodo_envio" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            <option value="">Seleccionar método</option>
                            <option value="email">Email</option>
                            <option value="plataforma">Plataforma digital</option>
                            <option value="fisico">Entrega física</option>
                        </select>
                    </div>
                </div>
                <div class="bg-blue-50 border-l-4 border-blue-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-info-circle text-blue-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-blue-700">
                                Se enviarán las nóminas a todos los empleados activos del mes seleccionado.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Enviar Nóminas</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Liquidación S.S. -->
    <div x-show="showModal === 'liquidacion-ss'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Liquidación de Cuotas S.S.</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('liquidacion-ss')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Mes de Liquidación</label>
                        <input type="month" x-model="formData.mes_liquidacion" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Liquidación</label>
                        <select x-model="formData.tipo_liquidacion" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            <option value="">Seleccionar tipo</option>
                            <option value="normal">Normal</option>
                            <option value="complementaria">Complementaria</option>
                            <option value="negativa">Negativa</option>
                        </select>
                    </div>
                </div>
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-yellow-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-yellow-700">
                                Se calculará automáticamente basándose en las nóminas del mes seleccionado.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Generar Liquidación</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Constitución de Empresas -->
    <div x-show="showModal === 'constitucion-empresas'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Constitución de Empresas</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('constitucion-empresas')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Forma Jurídica</label>
                        <select x-model="formData.forma_juridica" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            <option value="">Seleccionar forma</option>
                            <option value="sl">Sociedad Limitada</option>
                            <option value="sa">Sociedad Anónima</option>
                            <option value="slp">Sociedad Limitada Profesional</option>
                            <option value="cb">Comunidad de Bienes</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Denominación Social</label>
                        <input type="text" x-model="formData.denominacion" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Capital Social</label>
                        <input type="number" x-model="formData.capital_social" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Socios</label>
                        <input type="number" x-model="formData.numero_socios" min="1" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Objeto Social</label>
                        <textarea x-model="formData.objeto_social" rows="2" required class="w-full border border-gray-300 rounded-lg px-3 py-2"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Domicilio Social</label>
                        <input type="text" x-model="formData.domicilio_social" required class="w-full border border-gray-300 rounded-lg px-3 py-2">
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Iniciar Constitución</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Libros Obligatorios -->
    <div x-show="showModal === 'libros-obligatorios'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Libros Obligatorios</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-book text-blue-600 text-2xl mr-3"></i>
                            <h4 class="text-lg font-semibold text-blue-900">Libro de Ingresos</h4>
                        </div>
                        <p class="text-blue-700 text-sm mb-4">Registro de todos los ingresos de la actividad empresarial</p>
                        <div class="space-y-2">
                            <button @click="showModal = 'libro-ingresos'" class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700">
                                <i class="fas fa-plus mr-2"></i>Nuevo Registro
                            </button>
                            <button class="w-full bg-blue-100 text-blue-600 px-4 py-2 rounded-lg text-sm hover:bg-blue-200">
                                <i class="fas fa-download mr-2"></i>Exportar PDF
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-red-50 border border-red-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-book text-red-600 text-2xl mr-3"></i>
                            <h4 class="text-lg font-semibold text-red-900">Libro de Gastos</h4>
                        </div>
                        <p class="text-red-700 text-sm mb-4">Registro de todos los gastos deducibles de la actividad</p>
                        <div class="space-y-2">
                            <button @click="showModal = 'libro-gastos'" class="w-full bg-red-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-red-700">
                                <i class="fas fa-plus mr-2"></i>Nuevo Registro
                            </button>
                            <button class="w-full bg-red-100 text-red-600 px-4 py-2 rounded-lg text-sm hover:bg-red-200">
                                <i class="fas fa-download mr-2"></i>Exportar PDF
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-green-50 border border-green-200 rounded-lg p-6">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-coins text-green-600 text-2xl mr-3"></i>
                            <h4 class="text-lg font-semibold text-green-900">Libro de Bienes de Inversión</h4>
                        </div>
                        <p class="text-green-700 text-sm mb-4">Registro de amortizaciones y bienes de inversión</p>
                        <div class="space-y-2">
                            <button @click="showModal = 'bienes-inversion'" class="w-full bg-green-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-green-700">
                                <i class="fas fa-plus mr-2"></i>Nuevo Bien
                            </button>
                            <button class="w-full bg-green-100 text-green-600 px-4 py-2 rounded-lg text-sm hover:bg-green-200">
                                <i class="fas fa-download mr-2"></i>Exportar PDF
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 bg-gray-50 rounded-lg p-6">
                    <h4 class="text-lg font-semibold text-gray-900 mb-4">Resumen de Libros</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-600 mb-1">247</div>
                            <div class="text-sm text-gray-600">Registros de Ingresos</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-red-600 mb-1">189</div>
                            <div class="text-sm text-gray-600">Registros de Gastos</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-green-600 mb-1">12</div>
                            <div class="text-sm text-gray-600">Bienes de Inversión</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Calendario Fiscal -->
    <div x-show="showModal === 'calendario-fiscal'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-screen overflow-y-auto relative">
            <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                <h3 class="text-lg font-semibold text-gray-900">Calendario Fiscal Automático</h3>
                <button @click="showModal = null" class="text-gray-400 hover:text-gray-600 text-xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div>
                        <h4 class="text-lg font-semibold text-gray-900 mb-4">Próximos Vencimientos</h4>
                        <div class="space-y-3">
                            <div class="bg-red-50 border-l-4 border-red-400 p-4 rounded">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h5 class="font-medium text-red-800">Modelo 303 - IVA 4º Trimestre</h5>
                                        <p class="text-sm text-red-600">Vence: 30 Enero 2024</p>
                                    </div>
                                    <span class="bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full">2 días</span>
                                </div>
                            </div>
                            
                            <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h5 class="font-medium text-yellow-800">Modelo 130 - IRPF 4º Trimestre</h5>
                                        <p class="text-sm text-yellow-600">Vence: 30 Enero 2024</p>
                                    </div>
                                    <span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full">2 días</span>
                                </div>
                            </div>
                            
                            <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h5 class="font-medium text-blue-800">Declaración Renta 2023</h5>
                                        <p class="text-sm text-blue-600">Vence: 30 Junio 2024</p>
                                    </div>
                                    <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">150 días</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6 space-y-3">
                            <button @click="submitForm('configurar-recordatorios')" class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                                <i class="fas fa-bell mr-2"></i>Configurar Recordatorios
                            </button>
                            <button @click="showModal = null" class="w-full bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700">
                                Cerrar
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-semibold text-gray-900 mb-4">Calendario Anual 2024</h4>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="grid grid-cols-3 gap-4 text-sm">
                                <div>
                                    <h6 class="font-medium text-gray-700 mb-2">1º Trimestre</h6>
                                    <ul class="space-y-1 text-gray-600">
                                        <li>• 20 Ene: Mod. 303, 130</li>
                                        <li>• 20 Feb: Mod. 303, 130</li>
                                        <li>• 20 Mar: Mod. 303, 130</li>
                                        <li>• 25 Abr: Mod. 303, 130</li>
                                    </ul>
                                </div>
                                <div>
                                    <h6 class="font-medium text-gray-700 mb-2">2º Trimestre</h6>
                                    <ul class="space-y-1 text-gray-600">
                                        <li>• 20 Abr: Mod. 303, 130</li>
                                        <li>• 20 May: Mod. 303, 130</li>
                                        <li>• 20 Jun: Mod. 303, 130</li>
                                        <li>• 25 Jul: Mod. 303, 130</li>
                                    </ul>
                                </div>
                                <div>
                                    <h6 class="font-medium text-gray-700 mb-2">3º Trimestre</h6>
                                    <ul class="space-y-1 text-gray-600">
                                        <li>• 20 Jul: Mod. 303, 130</li>
                                        <li>• 20 Ago: Mod. 303, 130</li>
                                        <li>• 20 Sep: Mod. 303, 130</li>
                                        <li>• 25 Oct: Mod. 303, 130</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Histórico de Modelos -->
    <div x-show="showModal === 'historico-modelos'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Histórico de Modelos Presentados</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <div class="flex space-x-4">
                        <select class="border border-gray-300 rounded-lg px-3 py-2">
                            <option>Todos los modelos</option>
                            <option>Modelo 303</option>
                            <option>Modelo 130</option>
                            <option>Modelo 390</option>
                            <option>Modelo 100</option>
                        </select>
                        <select class="border border-gray-300 rounded-lg px-3 py-2">
                            <option>2024</option>
                            <option>2023</option>
                            <option>2022</option>
                        </select>
                    </div>
                    <button class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                        <i class="fas fa-download mr-2"></i>Exportar Histórico
                    </button>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Modelo</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Período</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Fecha Presentación</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Estado</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Importe</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Acciones</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">303</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">3T 2023</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">20/10/2023</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Presentado</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">€432.50</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <button class="text-blue-600 hover:text-blue-900 mr-3">
                                        <i class="fas fa-download"></i>
                                    </button>
                                    <button class="text-gray-600 hover:text-gray-900">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">130</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">3T 2023</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">20/10/2023</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Presentado</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">€285.75</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <button class="text-blue-600 hover:text-blue-900 mr-3">
                                        <i class="fas fa-download"></i>
                                    </button>
                                    <button class="text-gray-600 hover:text-gray-900">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">303</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2T 2023</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">20/07/2023</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Presentado</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">€398.20</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">
                                    <button class="text-blue-600 hover:text-blue-900 mr-3">
                                        <i class="fas fa-download"></i>
                                    </button>
                                    <button class="text-gray-600 hover:text-gray-900">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Notificaciones y Ayuda -->
    <div x-show="showModal === 'notificaciones-ayuda'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Notificaciones y Ayuda para Presentar Online</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div>
                        <h4 class="text-lg font-semibold text-gray-900 mb-4">Centro de Notificaciones</h4>
                        <div class="space-y-3">
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="flex items-start">
                                    <i class="fas fa-info-circle text-blue-500 mt-1 mr-3"></i>
                                    <div>
                                        <h5 class="font-medium text-blue-900">Nueva normativa IVA</h5>
                                        <p class="text-sm text-blue-700 mt-1">Cambios en los tipos de IVA para servicios digitales</p>
                                        <span class="text-xs text-blue-600">Hace 2 horas</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                <div class="flex items-start">
                                    <i class="fas fa-exclamation-triangle text-yellow-500 mt-1 mr-3"></i>
                                    <div>
                                        <h5 class="font-medium text-yellow-900">Recordatorio: Modelo 303</h5>
                                        <p class="text-sm text-yellow-700 mt-1">Vence en 3 días - 20 Enero 2024</p>
                                        <span class="text-xs text-yellow-600">Hace 1 día</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                <div class="flex items-start">
                                    <i class="fas fa-check-circle text-green-500 mt-1 mr-3"></i>
                                    <div>
                                        <h5 class="font-medium text-green-900">Presentación exitosa</h5>
                                        <p class="text-sm text-green-700 mt-1">Modelo 130 3T presentado correctamente</p>
                                        <span class="text-xs text-green-600">Hace 3 días</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6">
                            <button class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                                <i class="fas fa-cog mr-2"></i>Configurar Notificaciones
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-semibold text-gray-900 mb-4">Ayuda para Presentación Online</h4>
                        <div class="space-y-4">
                            <div class="border border-gray-200 rounded-lg p-4">
                                <h5 class="font-medium text-gray-900 mb-2">Certificado Digital</h5>
                                <p class="text-sm text-gray-600 mb-3">Gestiona tu certificado digital para presentar modelos</p>
                                <div class="flex space-x-2">
                                    <button class="bg-blue-100 text-blue-600 px-3 py-1 rounded text-sm hover:bg-blue-200">
                                        Instalar
                                    </button>
                                    <button class="bg-gray-100 text-gray-600 px-3 py-1 rounded text-sm hover:bg-gray-200">
                                        Verificar
                                    </button>
                                </div>
                            </div>
                            
                            <div class="border border-gray-200 rounded-lg p-4">
                                <h5 class="font-medium text-gray-900 mb-2">Enlaces Útiles</h5>
                                <ul class="space-y-2 text-sm">
                                    <li>
                                        <a href="#" class="text-blue-600 hover:text-blue-800 flex items-center">
                                            <i class="fas fa-external-link-alt mr-2 text-xs"></i>
                                            Portal AEAT
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" class="text-blue-600 hover:text-blue-800 flex items-center">
                                            <i class="fas fa-external-link-alt mr-2 text-xs"></i>
                                            Cl@ve PIN
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#" class="text-blue-600 hover:text-blue-800 flex items-center">
                                            <i class="fas fa-external-link-alt mr-2 text-xs"></i>
                                            Sede Electrónica
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            
                            <div class="border border-gray-200 rounded-lg p-4">
                                <h5 class="font-medium text-gray-900 mb-2">Tutoriales</h5>
                                <div class="space-y-2">
                                    <button class="w-full text-left bg-gray-50 p-2 rounded text-sm hover:bg-gray-100">
                                        <i class="fas fa-play-circle mr-2 text-blue-600"></i>
                                        Cómo presentar Modelo 303
                                    </button>
                                    <button class="w-full text-left bg-gray-50 p-2 rounded text-sm hover:bg-gray-100">
                                        <i class="fas fa-play-circle mr-2 text-blue-600"></i>
                                        Cómo presentar Modelo 130
                                    </button>
                                    <button class="w-full text-left bg-gray-50 p-2 rounded text-sm hover:bg-gray-100">
                                        <i class="fas fa-play-circle mr-2 text-blue-600"></i>
                                        Resolver errores comunes
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Ingresos Apps -->
    <div x-show="showModal === 'ingresos-apps'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Registrar Ingresos de Apps</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('ingresos-apps')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">App</label>
                        <select x-model="formData.app" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar app</option>
                            <option value="uber">Uber</option>
                            <option value="cabify">Cabify</option>
                            <option value="bolt">Bolt</option>
                            <option value="free_now">Free Now</option>
                            <option value="otras">Otras</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha</label>
                        <input type="date" x-model="formData.fecha" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Importe Bruto</label>
                        <input type="number" x-model="formData.importe_bruto" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Comisión App</label>
                        <input type="number" x-model="formData.comision" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Servicios</label>
                        <input type="number" x-model="formData.numero_servicios" min="1" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Vehículo</label>
                        <select x-model="formData.vehiculo" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar vehículo</option>
                            <option value="1234-ABC">Toyota Prius - 1234-ABC</option>
                            <option value="5678-DEF">Seat Leon - 5678-DEF</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Observaciones</label>
                    <textarea x-model="formData.observaciones" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Registrar Ingreso</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Ingresos TPV -->
    <div x-show="showModal === 'ingresos-tpv'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Registrar Ingresos por TPV</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('ingresos-tpv')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha</label>
                        <input type="date" x-model="formData.fecha" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Tarjeta</label>
                        <select x-model="formData.tipo_tarjeta" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="debito">Débito</option>
                            <option value="credito">Crédito</option>
                            <option value="contactless">Contactless</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Importe</label>
                        <input type="number" x-model="formData.importe" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Comisión TPV</label>
                        <input type="number" x-model="formData.comision_tpv" step="0.01" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Referencia</label>
                        <input type="text" x-model="formData.referencia" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Vehículo</label>
                        <select x-model="formData.vehiculo" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar vehículo</option>
                            <option value="1234-ABC">Toyota Prius - 1234-ABC</option>
                            <option value="5678-DEF">Seat Leon - 5678-DEF</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Descripción del Servicio</label>
                    <textarea x-model="formData.descripcion" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Registrar Ingreso</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Ingresos Efectivo -->
    <div x-show="showModal === 'ingresos-efectivo'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Registrar Ingresos en Efectivo</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('ingresos-efectivo')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha</label>
                        <input type="date" x-model="formData.fecha" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Importe Total</label>
                        <input type="number" x-model="formData.importe_total" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Servicios</label>
                        <input type="number" x-model="formData.numero_servicios" min="1" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Importe Promedio</label>
                        <input type="number" x-model="formData.importe_promedio" step="0.01" readonly class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Vehículo</label>
                        <select x-model="formData.vehiculo" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar vehículo</option>
                            <option value="1234-ABC">Toyota Prius - 1234-ABC</option>
                            <option value="5678-DEF">Seat Leon - 5678-DEF</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Turno</label>
                        <select x-model="formData.turno" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar turno</option>
                            <option value="mañana">Mañana (06:00 - 14:00)</option>
                            <option value="tarde">Tarde (14:00 - 22:00)</option>
                            <option value="noche">Noche (22:00 - 06:00)</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Observaciones</label>
                    <textarea x-model="formData.observaciones" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Registrar Ingreso</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Facturación Empresas -->
    <div x-show="showModal === 'facturacion-empresas'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Facturación a Empresas</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('facturacion-empresas')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Empresa Cliente</label>
                        <input type="text" x-model="formData.empresa_cliente" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">CIF/NIF</label>
                        <input type="text" x-model="formData.cif_nif" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Factura</label>
                        <input type="text" x-model="formData.numero_factura" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Factura</label>
                        <input type="date" x-model="formData.fecha_factura" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Base Imponible</label>
                        <input type="number" x-model="formData.base_imponible" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo IVA</label>
                        <select x-model="formData.tipo_iva" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="21">21% - General</option>
                            <option value="10">10% - Reducido</option>
                            <option value="4">4% - Superreducido</option>
                            <option value="0">0% - Exento</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Forma de Pago</label>
                        <select x-model="formData.forma_pago" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar forma</option>
                            <option value="contado">Contado</option>
                            <option value="30_dias">30 días</option>
                            <option value="60_dias">60 días</option>
                            <option value="90_dias">90 días</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Estado</label>
                        <select x-model="formData.estado" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar estado</option>
                            <option value="emitida">Emitida</option>
                            <option value="enviada">Enviada</option>
                            <option value="cobrada">Cobrada</option>
                            <option value="vencida">Vencida</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Concepto/Descripción</label>
                    <textarea x-model="formData.concepto" rows="3" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Crear Factura</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Transferencia Bancaria -->
    <div x-show="showModal === 'transferencia-bancaria'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Registrar Transferencia Bancaria</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('transferencia-bancaria')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Transferencia</label>
                        <input type="date" x-model="formData.fecha_transferencia" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Importe</label>
                        <input type="number" x-model="formData.importe" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Cliente/Ordenante</label>
                        <input type="text" x-model="formData.cliente" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Referencia</label>
                        <input type="text" x-model="formData.referencia" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Cuenta Destino</label>
                        <select x-model="formData.cuenta_destino" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar cuenta</option>
                            <option value="principal">Cuenta Principal</option>
                            <option value="secundaria">Cuenta Secundaria</option>
                            <option value="empresa">Cuenta Empresa</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Servicio</label>
                        <select x-model="formData.tipo_servicio" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="taxi">Servicio Taxi</option>
                            <option value="vtc">Servicio VTC</option>
                            <option value="contrato">Contrato Empresarial</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Concepto</label>
                    <textarea x-model="formData.concepto" rows="3" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div class="bg-blue-50 border-l-4 border-blue-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-info-circle text-blue-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-blue-700">
                                Asegúrate de que el importe coincide con el extracto bancario.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Registrar Transferencia</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Renunciar Autorización VTC -->
    <div x-show="showModal === 'renunciar-autorizacion'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Renunciar a la Autorización VTC</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('renunciar-autorizacion')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Autorización</label>
                        <input type="text" x-model="formData.numero_autorizacion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">NIF Titular</label>
                        <input type="text" x-model="formData.nif_titular" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Renuncia</label>
                        <input type="date" x-model="formData.fecha_renuncia" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Motivo de Renuncia</label>
                        <select x-model="formData.motivo_renuncia" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar motivo</option>
                            <option value="cese_actividad">Cese de actividad</option>
                            <option value="cambio_sector">Cambio de sector</option>
                            <option value="jubilacion">Jubilación</option>
                            <option value="otros">Otros motivos</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Vehículos Afectados</label>
                        <input type="number" x-model="formData.vehiculos_afectados" min="1" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha Efectiva</label>
                        <input type="date" x-model="formData.fecha_efectiva" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Observaciones</label>
                    <textarea x-model="formData.observaciones" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500" placeholder="Detalles adicionales sobre la renuncia..."></textarea>
                </div>
                <div class="bg-red-50 border-l-4 border-red-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-red-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-red-700">
                                <strong>Advertencia:</strong> La renuncia a la autorización VTC es irreversible. Una vez procesada, no podrá recuperar la autorización.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">Procesar Renuncia</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Reducir Flota VTC -->
    <div x-show="showModal === 'reducir-flota'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Reducir Flota VTC</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('reducir-flota')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Autorización</label>
                        <input type="text" x-model="formData.numero_autorizacion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Vehículos Actuales</label>
                        <input type="number" x-model="formData.vehiculos_actuales" readonly class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Vehículos a Reducir</label>
                        <input type="number" x-model="formData.vehiculos_reducir" min="1" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Vehículos Resultantes</label>
                        <input type="number" x-model="formData.vehiculos_resultantes" readonly class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Reducción</label>
                        <input type="date" x-model="formData.fecha_reduccion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Motivo de Reducción</label>
                        <select x-model="formData.motivo_reduccion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar motivo</option>
                            <option value="reduccion_actividad">Reducción de actividad</option>
                            <option value="problemas_financieros">Problemas financieros</option>
                            <option value="cambio_estrategia">Cambio de estrategia empresarial</option>
                            <option value="otros">Otros motivos</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Vehículos a Dar de Baja</label>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
                            <div>
                                <span class="font-medium">Toyota Prius - 1234-ABC</span>
                                <p class="text-sm text-gray-500">Año: 2020</p>
                            </div>
                            <input type="checkbox" x-model="formData.vehiculo_1234_abc" class="h-4 w-4 text-blue-600">
                        </div>
                        <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
                            <div>
                                <span class="font-medium">Seat Leon - 5678-DEF</span>
                                <p class="text-sm text-gray-500">Año: 2019</p>
                            </div>
                            <input type="checkbox" x-model="formData.vehiculo_5678_def" class="h-4 w-4 text-blue-600">
                        </div>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Justificación</label>
                    <textarea x-model="formData.justificacion" rows="3" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500" placeholder="Explicar los motivos de la reducción..."></textarea>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700">Solicitar Reducción</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Sustituir Vehículo VTC -->
    <div x-show="showModal === 'sustituir-vehiculo-vtc'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Sustituir Vehículo VTC</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('sustituir-vehiculo-vtc')" class="p-6 space-y-4">
                <div class="space-y-6">
                    <div class="border-b border-gray-200 pb-4">
                        <h4 class="text-lg font-medium text-gray-900 mb-4">Vehículo a Sustituir</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Matrícula Actual</label>
                                <input type="text" x-model="formData.matricula_actual" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Marca y Modelo</label>
                                <input type="text" x-model="formData.marca_modelo_actual" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Motivo de Sustitución</label>
                                <select x-model="formData.motivo_sustitucion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                    <option value="">Seleccionar motivo</option>
                                    <option value="averia_total">Avería total</option>
                                    <option value="accidente">Accidente</option>
                                    <option value="antigüedad">Antigüedad del vehículo</option>
                                    <option value="mejora_flota">Mejora de flota</option>
                                    <option value="otros">Otros motivos</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Sustitución</label>
                                <input type="date" x-model="formData.fecha_sustitucion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>

                    <div>
                        <h4 class="text-lg font-medium text-gray-900 mb-4">Nuevo Vehículo</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Nueva Matrícula</label>
                                <input type="text" x-model="formData.matricula_nueva" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Marca y Modelo Nuevo</label>
                                <input type="text" x-model="formData.marca_modelo_nuevo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Año del Vehículo</label>
                                <input type="number" x-model="formData.año_vehiculo" min="2000" max="2024" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Número de Bastidor</label>
                                <input type="text" x-model="formData.numero_bastidor" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Número de Plazas</label>
                                <input type="number" x-model="formData.numero_plazas" min="4" max="9" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Color del Vehículo</label>
                                <input type="text" x-model="formData.color_vehiculo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Documentación Adjunta</label>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                        <i class="fas fa-cloud-upload-alt text-gray-400 text-3xl mb-2"></i>
                        <p class="text-gray-500">Permiso de circulación, ITV, seguro del nuevo vehículo</p>
                        <input type="file" multiple class="hidden">
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Solicitar Sustitución</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Sustitución Provisional VTC -->
    <div x-show="showModal === 'sustitucion-provisional'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Sustitución Provisional por Avería</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('sustitucion-provisional')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Matrícula Vehículo Averiado</label>
                        <input type="text" x-model="formData.matricula_averiado" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Avería</label>
                        <input type="date" x-model="formData.fecha_averia" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Avería</label>
                        <select x-model="formData.tipo_averia" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="motor">Avería de motor</option>
                            <option value="transmision">Avería de transmisión</option>
                            <option value="accidente">Accidente</option>
                            <option value="electrica">Avería eléctrica</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tiempo Estimado de Reparación</label>
                        <select x-model="formData.tiempo_reparacion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tiempo</option>
                            <option value="1-3_dias">1-3 días</option>
                            <option value="1_semana">1 semana</option>
                            <option value="2_semanas">2 semanas</option>
                            <option value="1_mes">1 mes</option>
                            <option value="mas_1_mes">Más de 1 mes</option>
                        </select>
                    </div>
                </div>

                <div class="border-t border-gray-200 pt-4">
                    <h4 class="text-lg font-medium text-gray-900 mb-4">Vehículo Sustituto</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Matrícula Sustituto</label>
                            <input type="text" x-model="formData.matricula_sustituto" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Marca y Modelo</label>
                            <input type="text" x-model="formData.marca_modelo_sustituto" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fecha Inicio Sustitución</label>
                            <input type="date" x-model="formData.fecha_inicio_sustitucion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fecha Fin Estimada</label>
                            <input type="date" x-model="formData.fecha_fin_estimada" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Descripción de la Avería</label>
                    <textarea x-model="formData.descripcion_averia" rows="3" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500" placeholder="Describir detalladamente la avería..."></textarea>
                </div>

                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-yellow-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-yellow-700">
                                La sustitución provisional está limitada a un máximo de 3 meses. Debe comunicar la finalización de la reparación.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-yellow-600 text-white px-6 py-2 rounded-lg hover:bg-yellow-700">Solicitar Sustitución</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Cambiar Domicilio VTC -->
    <div x-show="showModal === 'cambiar-domicilio'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Cambiar Domicilio VTC</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('cambiar-domicilio')" class="p-6 space-y-4">
                <div class="space-y-6">
                    <div class="border-b border-gray-200 pb-4">
                        <h4 class="text-lg font-medium text-gray-900 mb-4">Domicilio Actual</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Dirección Actual</label>
                                <input type="text" x-model="formData.direccion_actual" readonly class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Código Postal Actual</label>
                                <input type="text" x-model="formData.cp_actual" readonly class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Localidad Actual</label>
                                <input type="text" x-model="formData.localidad_actual" readonly class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Provincia Actual</label>
                                <input type="text" x-model="formData.provincia_actual" readonly class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-50">
                            </div>
                        </div>
                    </div>

                    <div>
                        <h4 class="text-lg font-medium text-gray-900 mb-4">Nuevo Domicilio</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Nueva Dirección</label>
                                <input type="text" x-model="formData.direccion_nueva" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500" placeholder="Calle, número, piso...">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Nuevo Código Postal</label>
                                <input type="text" x-model="formData.cp_nuevo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Nueva Localidad</label>
                                <input type="text" x-model="formData.localidad_nueva" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Nueva Provincia</label>
                                <select x-model="formData.provincia_nueva" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                    <option value="">Seleccionar provincia</option>
                                    <option value="Madrid">Madrid</option>
                                    <option value="Barcelona">Barcelona</option>
                                    <option value="Valencia">Valencia</option>
                                    <option value="Sevilla">Sevilla</option>
                                    <option value="Bilbao">Bilbao</option>
                                    <option value="Málaga">Málaga</option>
                                    <option value="Otras">Otras</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Cambio</label>
                                <input type="date" x-model="formData.fecha_cambio" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Motivo del Cambio</label>
                                <select x-model="formData.motivo_cambio" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                    <option value="">Seleccionar motivo</option>
                                    <option value="traslado_personal">Traslado personal</option>
                                    <option value="expansion_negocio">Expansión del negocio</option>
                                    <option value="mejores_condiciones">Mejores condiciones</option>
                                    <option value="otros">Otros motivos</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Documentación de Apoyo</label>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                        <i class="fas fa-cloud-upload-alt text-gray-400 text-3xl mb-2"></i>
                        <p class="text-gray-500">Contrato de alquiler, escritura de propiedad, etc.</p>
                        <input type="file" multiple class="hidden">
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Solicitar Cambio</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Distintivo VTC -->
    <div x-show="showModal === 'distintivo-vtc'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Solicitar Distintivo VTC</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('distintivo-vtc')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Autorización VTC</label>
                        <input type="text" x-model="formData.numero_autorizacion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Matrícula del Vehículo</label>
                        <input type="text" x-model="formData.matricula_vehiculo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Distintivo</label>
                        <select x-model="formData.tipo_distintivo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="nuevo">Nuevo distintivo</option>
                            <option value="renovacion">Renovación de distintivo</option>
                            <option value="duplicado">Duplicado por pérdida/robo</option>
                            <option value="deterioro">Sustitución por deterioro</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Cantidad Solicitada</label>
                        <input type="number" x-model="formData.cantidad" min="1" max="10" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Dirección de Envío</label>
                        <textarea x-model="formData.direccion_envio" rows="2" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500" placeholder="Dirección completa para el envío"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Teléfono de Contacto</label>
                        <input type="tel" x-model="formData.telefono" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <div x-show="formData.tipo_distintivo === 'duplicado'" class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                    <h5 class="font-medium text-yellow-800 mb-2">Información adicional para duplicado</h5>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fecha del Incidente</label>
                            <input type="date" x-model="formData.fecha_incidente" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Número de Denuncia (si aplica)</label>
                            <input type="text" x-model="formData.numero_denuncia" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                    </div>
                    <div class="mt-3">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Descripción del Incidente</label>
                        <textarea x-model="formData.descripcion_incidente" rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2"></textarea>
                    </div>
                </div>

                <div class="bg-blue-50 border-l-4 border-blue-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-info-circle text-blue-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-blue-700">
                                <strong>Información:</strong> El distintivo VTC debe estar visible en la parte frontal del vehículo. 
                                El plazo de entrega es de 15 días laborables.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700">Solicitar Distintivo</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Renovar Autorización VTC -->
    <div x-show="showModal === 'renovar-autorizacion-vtc'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Renovar Autorización VTC (Visar)</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('renovar-autorizacion-vtc')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Autorización</label>
                        <input type="text" x-model="formData.numero_autorizacion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Vencimiento Actual</label>
                        <input type="date" x-model="formData.fecha_vencimiento" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">NIF/CIF Titular</label>
                        <input type="text" x-model="formData.nif_titular" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Solicitud de Renovación</label>
                        <input type="date" x-model="formData.fecha_solicitud" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Vehículos</label>
                        <input type="number" x-model="formData.numero_vehiculos" min="1" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Estado de la Actividad</label>
                        <select x-model="formData.estado_actividad" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar estado</option>
                            <option value="activa">Actividad activa</option>
                            <option value="suspendida">Actividad suspendida</option>
                            <option value="inactiva">Actividad inactiva</option>
                        </select>
                    </div>
                </div>

                <div class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Lista de Vehículos</h4>
                    <div class="space-y-3">
                        <div class="border border-gray-200 rounded-lg p-4">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Matrícula</label>
                                    <input type="text" x-model="formData.vehiculo1_matricula" class="w-full border border-gray-300 rounded px-2 py-1 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Marca/Modelo</label>
                                    <input type="text" x-model="formData.vehiculo1_marca" class="w-full border border-gray-300 rounded px-2 py-1 text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Año</label>
                                    <input type="number" x-model="formData.vehiculo1_año" class="w-full border border-gray-300 rounded px-2 py-1 text-sm">
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="text-blue-600 hover:text-blue-800 text-sm">
                        <i class="fas fa-plus mr-1"></i>Agregar otro vehículo
                    </button>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Documentos Requeridos</label>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.doc_seguro" class="mr-2">
                            <span class="text-sm">Póliza de seguro vigente</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.doc_itv" class="mr-2">
                            <span class="text-sm">Certificado ITV vigente</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.doc_circulacion" class="mr-2">
                            <span class="text-sm">Permiso de circulación</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.doc_fiscal" class="mr-2">
                            <span class="text-sm">Certificado de estar al corriente de obligaciones fiscales</span>
                        </label>
                    </div>
                </div>

                <div class="bg-green-50 border-l-4 border-green-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-check-circle text-green-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-green-700">
                                <strong>Recordatorio:</strong> La renovación debe solicitarse con al menos 30 días de antelación 
                                a la fecha de vencimiento para evitar interrupciones en la actividad.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Solicitar Renovación</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Matriculación de Vehículos -->
    <div x-show="showModal === 'matriculacion-vehiculos'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Matriculación de Vehículos</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('matriculacion-vehiculos')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Vehículo</label>
                        <select x-model="formData.tipo_vehiculo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="turismo">Turismo</option>
                            <option value="comercial">Vehículo comercial</option>
                            <option value="motocicleta">Motocicleta</option>
                            <option value="remolque">Remolque</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Marca</label>
                        <input type="text" x-model="formData.marca" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Modelo</label>
                        <input type="text" x-model="formData.modelo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Año de Fabricación</label>
                        <input type="number" x-model="formData.año" min="1990" max="2024" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Bastidor</label>
                        <input type="text" x-model="formData.bastidor" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Color</label>
                        <input type="text" x-model="formData.color" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Combustible</label>
                        <select x-model="formData.combustible" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar combustible</option>
                            <option value="gasolina">Gasolina</option>
                            <option value="diesel">Diésel</option>
                            <option value="electrico">Eléctrico</option>
                            <option value="hibrido">Híbrido</option>
                            <option value="glp">GLP</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Cilindrada (cc)</label>
                        <input type="number" x-model="formData.cilindrada" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Plazas</label>
                        <input type="number" x-model="formData.plazas" min="1" max="55" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Peso Máximo (kg)</label>
                        <input type="number" x-model="formData.peso_maximo" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                
                <div class="border-t border-gray-200 pt-4">
                    <h4 class="text-lg font-medium text-gray-900 mb-4">Datos del Titular</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">NIF/NIE/CIF</label>
                            <input type="text" x-model="formData.nif_titular" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nombre/Razón Social</label>
                            <input type="text" x-model="formData.nombre_titular" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Dirección</label>
                            <input type="text" x-model="formData.direccion_titular" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <div class="bg-blue-50 border-l-4 border-blue-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-info-circle text-blue-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-blue-700">
                                <strong>Documentos necesarios:</strong> Certificado de conformidad, seguro obligatorio, justificante de pago del IVTM.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Solicitar Matriculación</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Transferencia y Bajas -->
    <div x-show="showModal === 'transferencia-bajas'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Transferencia y Bajas de Vehículos</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('transferencia-bajas')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Trámite</label>
                        <select x-model="formData.tipo_tramite" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar trámite</option>
                            <option value="transferencia">Transferencia de titular</option>
                            <option value="baja_temporal">Baja temporal</option>
                            <option value="baja_definitiva">Baja definitiva</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Matrícula del Vehículo</label>
                        <input type="text" x-model="formData.matricula" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <!-- Campos para Transferencia -->
                <div x-show="formData.tipo_tramite === 'transferencia'" class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Datos del Nuevo Titular</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">NIF/NIE/CIF Nuevo Titular</label>
                            <input type="text" x-model="formData.nif_nuevo_titular" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nombre/Razón Social</label>
                            <input type="text" x-model="formData.nombre_nuevo_titular" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Dirección Nuevo Titular</label>
                            <input type="text" x-model="formData.direccion_nuevo_titular" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <!-- Campos para Baja -->
                <div x-show="formData.tipo_tramite === 'baja_temporal' || formData.tipo_tramite === 'baja_definitiva'" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Motivo de la Baja</label>
                            <select x-model="formData.motivo_baja" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                <option value="">Seleccionar motivo</option>
                                <option value="siniestro_total">Siniestro total</option>
                                <option value="desguace">Desguace</option>
                                <option value="exportacion">Exportación</option>
                                <option value="otros">Otros motivos</option>
                            </select>
                        </div>
                        <div x-show="formData.tipo_tramite === 'baja_temporal'">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Duración (meses)</label>
                            <select x-model="formData.duracion_baja" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                <option value="">Seleccionar duración</option>
                                <option value="6">6 meses</option>
                                <option value="12">12 meses</option>
                                <option value="24">24 meses</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Observaciones</label>
                    <textarea x-model="formData.observaciones" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"></textarea>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Procesar Trámite</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Pliegos de Descargo -->
    <div x-show="showModal === 'pliegos-descargo'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Pliegos de Descargo</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('pliegos-descargo')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Expediente</label>
                        <input type="text" x-model="formData.numero_expediente" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de la Infracción</label>
                        <input type="date" x-model="formData.fecha_infraccion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Matrícula del Vehículo</label>
                        <input type="text" x-model="formData.matricula" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Importe de la Multa (€)</label>
                        <input type="number" x-model="formData.importe_multa" step="0.01" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Infracción</label>
                        <select x-model="formData.tipo_infraccion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="velocidad">Exceso de velocidad</option>
                            <option value="estacionamiento">Estacionamiento indebido</option>
                            <option value="semaforo">Saltarse semáforo</option>
                            <option value="documentacion">Falta de documentación</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Lugar de la Infracción</label>
                        <input type="text" x-model="formData.lugar_infraccion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Motivos de Alegación</label>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.motivo_identificacion" class="mr-2">
                            <span class="text-sm">Defectos en la identificación del conductor</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.motivo_prescripcion" class="mr-2">
                            <span class="text-sm">Prescripción de la infracción</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.motivo_procedimiento" class="mr-2">
                            <span class="text-sm">Defectos en el procedimiento</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.motivo_otros" class="mr-2">
                            <span class="text-sm">Otros motivos</span>
                        </label>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Alegaciones Detalladas</label>
                    <textarea x-model="formData.alegaciones" rows="5" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500" placeholder="Describe detalladamente los motivos de tu alegación..."></textarea>
                </div>

                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-yellow-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-yellow-700">
                                <strong>Importante:</strong> Dispone de 20 días naturales desde la notificación para presentar alegaciones.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Presentar Alegaciones</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Reformas de Vehículos -->
    <div x-show="showModal === 'reformas-vehiculos'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Reformas de Vehículos</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('reformas-vehiculos')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Matrícula del Vehículo</label>
                        <input type="text" x-model="formData.matricula" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Reforma</label>
                        <select x-model="formData.tipo_reforma" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="motor">Reforma de motor</option>
                            <option value="carroceria">Reforma de carrocería</option>
                            <option value="combustible">Cambio de combustible</option>
                            <option value="estructura">Reforma de estructura</option>
                            <option value="otras">Otras reformas</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de la Reforma</label>
                        <input type="date" x-model="formData.fecha_reforma" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Taller Autorizado</label>
                        <input type="text" x-model="formData.taller_autorizado" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <div x-show="formData.tipo_reforma === 'motor'" class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Detalles de Reforma de Motor</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nueva Cilindrada (cc)</label>
                            <input type="number" x-model="formData.nueva_cilindrada" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nueva Potencia (CV)</label>
                            <input type="number" x-model="formData.nueva_potencia" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <div x-show="formData.tipo_reforma === 'combustible'" class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Cambio de Combustible</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Combustible Anterior</label>
                            <select x-model="formData.combustible_anterior" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                <option value="">Seleccionar</option>
                                <option value="gasolina">Gasolina</option>
                                <option value="diesel">Diésel</option>
                                <option value="glp">GLP</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nuevo Combustible</label>
                            <select x-model="formData.combustible_nuevo" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                <option value="">Seleccionar</option>
                                <option value="glp">GLP</option>
                                <option value="gnc">GNC</option>
                                <option value="electrico">Eléctrico</option>
                                <option value="hibrido">Híbrido</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Descripción Detallada de la Reforma</label>
                    <textarea x-model="formData.descripcion_reforma" rows="4" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500" placeholder="Describe detalladamente las modificaciones realizadas..."></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Documentación Adjunta</label>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.doc_proyecto_tecnico" class="mr-2">
                            <span class="text-sm">Proyecto técnico</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.doc_certificado_taller" class="mr-2">
                            <span class="text-sm">Certificado del taller</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.doc_fotos" class="mr-2">
                            <span class="text-sm">Fotografías del vehículo</span>
                        </label>
                    </div>
                </div>

                <div class="bg-blue-50 border-l-4 border-blue-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-info-circle text-blue-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-blue-700">
                                <strong>Nota:</strong> Tras la reforma, será necesaria una inspección técnica para obtener la nueva tarjeta de inspección técnica.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Solicitar Reforma</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Renovación VT -->
    <div x-show="showModal === 'renovacion-vt'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Renovación VT (Visado de Taxi)</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('renovacion-vt')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Licencia Taxi</label>
                        <input type="text" x-model="formData.numero_licencia" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">NIF Titular</label>
                        <input type="text" x-model="formData.nif_titular" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Matrícula del Vehículo</label>
                        <input type="text" x-model="formData.matricula" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Vencimiento Actual</label>
                        <input type="date" x-model="formData.fecha_vencimiento" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Municipio de Operación</label>
                        <select x-model="formData.municipio" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar municipio</option>
                            <option value="madrid">Madrid</option>
                            <option value="barcelona">Barcelona</option>
                            <option value="valencia">Valencia</option>
                            <option value="sevilla">Sevilla</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Renovación</label>
                        <select x-model="formData.tipo_renovacion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="normal">Renovación normal</option>
                            <option value="cambio_vehiculo">Con cambio de vehículo</option>
                            <option value="cambio_titular">Con cambio de titular</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-medium text-gray-900 mb-3">Documentación Requerida</h4>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.doc_permiso_circulacion" class="mr-2">
                            <span class="text-sm">Permiso de circulación del vehículo</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.doc_seguro" class="mr-2">
                            <span class="text-sm">Póliza de seguro vigente</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.doc_itv" class="mr-2">
                            <span class="text-sm">Certificado ITV vigente</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.doc_carnet_conducir" class="mr-2">
                            <span class="text-sm">Carnet de conducir en vigor</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" x-model="formData.doc_certificado_antecedentes" class="mr-2">
                            <span class="text-sm">Certificado de antecedentes penales</span>
                        </label>
                    </div>
                </div>

                <div class="bg-blue-50 border-l-4 border-blue-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-info-circle text-blue-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-blue-700">
                                <strong>Importante:</strong> La renovación debe realizarse antes del vencimiento para evitar sanciones. 
                                Plazo de resolución: 30 días hábiles.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Solicitar Renovación</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Revisión Metropolitana -->
    <div x-show="showModal === 'revision-metropolitana'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Solicitar Cita Revisión Metropolitana</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('revision-metropolitana')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Matrícula del Vehículo</label>
                        <input type="text" x-model="formData.matricula" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Licencia</label>
                        <input type="text" x-model="formData.numero_licencia" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Centro de Revisión</label>
                        <select x-model="formData.centro_revision" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar centro</option>
                            <option value="villaverde">Villaverde</option>
                            <option value="leganes">Leganés</option>
                            <option value="alcorcon">Alcorcón</option>
                            <option value="mostoles">Móstoles</option>
                            <option value="fuenlabrada">Fuenlabrada</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Revisión</label>
                        <select x-model="formData.tipo_revision" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="periodica">Revisión periódica</option>
                            <option value="extraordinaria">Revisión extraordinaria</option>
                            <option value="duplicado">Revisión por duplicado</option>
                            <option value="cambio_vehiculo">Revisión cambio vehículo</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha Preferida</label>
                        <input type="date" x-model="formData.fecha_preferida" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Hora Preferida</label>
                        <select x-model="formData.hora_preferida" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar hora</option>
                            <option value="09:00">09:00</option>
                            <option value="10:00">10:00</option>
                            <option value="11:00">11:00</option>
                            <option value="12:00">12:00</option>
                            <option value="13:00">13:00</option>
                            <option value="16:00">16:00</option>
                            <option value="17:00">17:00</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Observaciones</label>
                    <textarea x-model="formData.observaciones" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500" placeholder="Información adicional sobre la cita..."></textarea>
                </div>

                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-yellow-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-yellow-700">
                                <strong>Importante:</strong> Debe acudir con el vehículo en perfecto estado de conservación y limpieza. 
                                Traer toda la documentación original.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Solicitar Cita</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Altas y Bajas Vehículos Taxi -->
    <div x-show="showModal === 'altas-bajas-vehiculos-taxi'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Altas y Bajas Vehículos Taxi</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('altas-bajas-vehiculos-taxi')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Trámite</label>
                        <select x-model="formData.tipo_tramite" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar trámite</option>
                            <option value="alta">Alta de vehículo</option>
                            <option value="baja">Baja de vehículo</option>
                            <option value="cambio">Cambio de vehículo</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Licencia</label>
                        <input type="text" x-model="formData.numero_licencia" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <!-- Campos para Alta/Cambio -->
                <div x-show="formData.tipo_tramite === 'alta' || formData.tipo_tramite === 'cambio'" class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Datos del Vehículo</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nueva Matrícula</label>
                            <input type="text" x-model="formData.matricula_nueva" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Marca y Modelo</label>
                            <input type="text" x-model="formData.marca_modelo" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Año de Fabricación</label>
                            <input type="number" x-model="formData.año_fabricacion" min="2000" max="2024" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Número de Plazas</label>
                            <input type="number" x-model="formData.numero_plazas" min="4" max="9" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Color del Vehículo</label>
                            <input type="text" x-model="formData.color" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Combustible</label>
                            <select x-model="formData.combustible" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                <option value="">Seleccionar combustible</option>
                                <option value="hibrido">Híbrido</option>
                                <option value="electrico">Eléctrico</option>
                                <option value="glp">GLP</option>
                                <option value="gnc">GNC</option>
                                <option value="gasolina">Gasolina</option>
                                <option value="diesel">Diésel</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Campos para Baja/Cambio -->
                <div x-show="formData.tipo_tramite === 'baja' || formData.tipo_tramite === 'cambio'" class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Vehículo a Dar de Baja</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Matrícula Actual</label>
                            <input type="text" x-model="formData.matricula_actual" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Motivo de Baja</label>
                            <select x-model="formData.motivo_baja" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                <option value="">Seleccionar motivo</option>
                                <option value="antiguedad">Antigüedad del vehículo</option>
                                <option value="averia">Avería irreparable</option>
                                <option value="accidente">Accidente total</option>
                                <option value="venta">Venta del vehículo</option>
                                <option value="otros">Otros motivos</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Observaciones</label>
                    <textarea x-model="formData.observaciones" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"></textarea>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Procesar Trámite</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Altas y Bajas Asalariados Taxi -->
    <div x-show="showModal === 'altas-bajas-asalariados-taxi'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Altas y Bajas Conductores Asalariados</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('altas-bajas-asalariados-taxi')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Trámite</label>
                        <select x-model="formData.tipo_tramite" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar trámite</option>
                            <option value="alta">Alta de conductor</option>
                            <option value="baja">Baja de conductor</option>
                            <option value="modificacion">Modificación de datos</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Licencia</label>
                        <input type="text" x-model="formData.numero_licencia" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <!-- Datos del Conductor -->
                <div class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Datos del Conductor</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nombre Completo</label>
                            <input type="text" x-model="formData.nombre_conductor" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">DNI/NIE</label>
                            <input type="text" x-model="formData.dni_conductor" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Número de Carnet de Conducir</label>
                            <input type="text" x-model="formData.carnet_conducir" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Caducidad Carnet</label>
                            <input type="date" x-model="formData.caducidad_carnet" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Número de Seguridad Social</label>
                            <input type="text" x-model="formData.seguridad_social" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Nacimiento</label>
                            <input type="date" x-model="formData.fecha_nacimiento" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <!-- Datos del Contrato para Alta -->
                <div x-show="formData.tipo_tramite === 'alta'" class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Datos del Contrato</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Inicio</label>
                            <input type="date" x-model="formData.fecha_inicio" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Contrato</label>
                            <select x-model="formData.tipo_contrato" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                <option value="">Seleccionar tipo</option>
                                <option value="indefinido">Indefinido</option>
                                <option value="temporal">Temporal</option>
                                <option value="obras_servicios">Obra y servicio</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Salario Base</label>
                            <input type="number" x-model="formData.salario_base" step="0.01" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Jornada</label>
                            <select x-model="formData.jornada" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                <option value="">Seleccionar jornada</option>
                                <option value="completa">Completa</option>
                                <option value="parcial">Parcial</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Motivo de Baja -->
                <div x-show="formData.tipo_tramite === 'baja'" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Baja</label>
                            <input type="date" x-model="formData.fecha_baja" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Motivo de Baja</label>
                            <select x-model="formData.motivo_baja" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                <option value="">Seleccionar motivo</option>
                                <option value="dimision">Dimisión</option>
                                <option value="despido">Despido</option>
                                <option value="fin_contrato">Fin de contrato</option>
                                <option value="jubilacion">Jubilación</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="bg-blue-50 border-l-4 border-blue-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-info-circle text-blue-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-blue-700">
                                <strong>Documentación necesaria:</strong> DNI/NIE, carnet de conducir, certificado de antecedentes penales, 
                                certificado médico y contrato de trabajo.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Procesar Trámite</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Altas Autónomos/Familiares -->
    <div x-show="showModal === 'altas-autonomos-familiares'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Altas Autónomos/Familiares Colaboradores</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('altas-autonomos-familiares')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Alta</label>
                        <select x-model="formData.tipo_alta" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="autonomo">Autónomo colaborador</option>
                            <option value="familiar">Familiar colaborador</option>
                            <option value="sociedad">Conductor de sociedad</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Licencia</label>
                        <input type="text" x-model="formData.numero_licencia" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <!-- Datos Personales -->
                <div class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Datos Personales</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nombre Completo</label>
                            <input type="text" x-model="formData.nombre_completo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">DNI/NIE</label>
                            <input type="text" x-model="formData.dni" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Nacimiento</label>
                            <input type="date" x-model="formData.fecha_nacimiento" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Teléfono</label>
                            <input type="tel" x-model="formData.telefono" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Dirección Completa</label>
                            <input type="text" x-model="formData.direccion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <!-- Datos del Carnet -->
                <div class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Datos del Carnet de Conducir</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Número de Carnet</label>
                            <input type="text" x-model="formData.numero_carnet" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Caducidad</label>
                            <input type="date" x-model="formData.caducidad_carnet" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Puntos Actuales</label>
                            <input type="number" x-model="formData.puntos_carnet" min="0" max="15" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Años de Antigüedad</label>
                            <input type="number" x-model="formData.anos_carnet" min="0" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <!-- Información específica para Familiares -->
                <div x-show="formData.tipo_alta === 'familiar'" class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Parentesco</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Relación Familiar</label>
                            <select x-model="formData.parentesco" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                <option value="">Seleccionar parentesco</option>
                                <option value="conyuge">Cónyuge</option>
                                <option value="hijo">Hijo/a</option>
                                <option value="hermano">Hermano/a</option>
                                <option value="padre">Padre/Madre</option>
                                <option value="otros">Otros</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">DNI del Titular de la Licencia</label>
                            <input type="text" x-model="formData.dni_titular" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-yellow-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-yellow-700">
                                <strong>Documentación requerida:</strong> DNI/NIE, carnet de conducir, certificado de antecedentes penales, 
                                certificado médico. Para familiares: libro de familia o certificado de empadronamiento.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700">Procesar Alta</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Sustituir Vehículo Taxi -->
    <div x-show="showModal === 'sustituir-vehiculo-taxi'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Sustituir Vehículo Taxi</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('sustituir-vehiculo-taxi')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Sustitución</label>
                        <select x-model="formData.tipo_sustitucion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar tipo</option>
                            <option value="definitiva">Sustitución definitiva</option>
                            <option value="temporal">Sustitución temporal</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Licencia</label>
                        <input type="text" x-model="formData.numero_licencia" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <!-- Vehículo Actual -->
                <div class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Vehículo Actual</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Matrícula Actual</label>
                            <input type="text" x-model="formData.matricula_actual" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Motivo de Sustitución</label>
                            <select x-model="formData.motivo_sustitucion" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                <option value="">Seleccionar motivo</option>
                                <option value="averia">Avería irreparable</option>
                                <option value="accidente">Accidente total</option>
                                <option value="antiguedad">Antigüedad excesiva</option>
                                <option value="mejora">Mejora de vehículo</option>
                                <option value="otros">Otros motivos</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Nuevo Vehículo -->
                <div class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Nuevo Vehículo</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nueva Matrícula</label>
                            <input type="text" x-model="formData.matricula_nueva" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Marca y Modelo</label>
                            <input type="text" x-model="formData.marca_modelo_nuevo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Año de Fabricación</label>
                            <input type="number" x-model="formData.año_nuevo" min="2000" max="2024" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Color</label>
                            <input type="text" x-model="formData.color_nuevo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Número de Plazas</label>
                            <input type="number" x-model="formData.plazas_nuevo" min="4" max="9" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Combustible</label>
                            <select x-model="formData.combustible_nuevo" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                                <option value="">Seleccionar combustible</option>
                                <option value="hibrido">Híbrido</option>
                                <option value="electrico">Eléctrico</option>
                                <option value="glp">GLP</option>
                                <option value="gnc">GNC</option>
                                <option value="gasolina">Gasolina</option>
                                <option value="diesel">Diésel</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Duración para sustitución temporal -->
                <div x-show="formData.tipo_sustitucion === 'temporal'" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Inicio</label>
                            <input type="date" x-model="formData.fecha_inicio_temporal" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Fin Estimada</label>
                            <input type="date" x-model="formData.fecha_fin_temporal" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Observaciones</label>
                    <textarea x-model="formData.observaciones" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500" placeholder="Detalles adicionales sobre la sustitución..."></textarea>
                </div>

                <div class="bg-blue-50 border-l-4 border-blue-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-info-circle text-blue-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-blue-700">
                                <strong>Documentación necesaria:</strong> Permiso de circulación, seguro, ITV, ficha técnica del nuevo vehículo 
                                y justificante del motivo de sustitución.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700">Procesar Sustitución</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Duplicados Permiso -->
    <div x-show="showModal === 'duplicados-permiso'" x-transition class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Duplicados Permiso de Conducir</h3>
                <button @click="showModal = null" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form @submit.prevent="submitForm('duplicados-permiso')" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">NIF/NIE</label>
                        <input type="text" x-model="formData.nif" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Número de Permiso</label>
                        <input type="text" x-model="formData.numero_permiso" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Motivo del Duplicado</label>
                        <select x-model="formData.motivo_duplicado" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                            <option value="">Seleccionar motivo</option>
                            <option value="perdida">Pérdida</option>
                            <option value="robo">Robo</option>
                            <option value="deterioro">Deterioro</option>
                            <option value="datos_erroneos">Datos erróneos</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha del Incidente</label>
                        <input type="date" x-model="formData.fecha_incidente" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Clases de Permiso</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" x-model="formData.clase_b" class="mr-2">
                                <span class="text-sm">B - Automóviles</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" x-model="formData.clase_c" class="mr-2">
                                <span class="text-sm">C - Camiones</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" x-model="formData.clase_d" class="mr-2">
                                <span class="text-sm">D - Autobuses</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" x-model="formData.clase_a" class="mr-2">
                                <span class="text-sm">A - Motocicletas</span>
                            </label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fecha de Vencimiento</label>
                        <input type="date" x-model="formData.fecha_vencimiento" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <div x-show="formData.motivo_duplicado === 'robo'" class="space-y-4">
                    <h4 class="text-lg font-medium text-gray-900">Información sobre el Robo</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Número de Denuncia</label>
                            <input type="text" x-model="formData.numero_denuncia" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Comisaría</label>
                            <input type="text" x-model="formData.comisaria" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Dirección de Envío</label>
                    <textarea x-model="formData.direccion_envio" rows="3" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500" placeholder="Dirección completa donde enviar el duplicado"></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Observaciones</label>
                    <textarea x-model="formData.observaciones" rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500" placeholder="Información adicional relevante"></textarea>
                </div>

                <div class="bg-green-50 border-l-4 border-green-400 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-check-circle text-green-400"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-green-700">
                                <strong>Información:</strong> El duplicado será enviado por correo certificado en un plazo de 15 días laborables.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showModal = null" class="px-4 py-2 text-gray-600 hover:text-gray-800">Cancelar</button>
                    <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Solicitar Duplicado</button>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
.switch {
    position: relative;
    display: inline-block;
    width: 60px;
    height: 34px;
}

.switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 34px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 26px;
    width: 26px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

input:checked + .slider {
    background-color: #2196F3;
}

input:checked + .slider:before {
    transform: translateX(26px);
}
</style>

<script>
function dashboard() {
    return {
        currentSection: 'inicio',
        initialized: false,
        showEmpresaModal: false,
        showAutonomoModal: false,
        showModal: null,
        sectionData: {},
        loading: false,
        formData: {},
        automatizaciones: {
            facturas_auto: false,
            backup_auto: true,
            analisis_gastos: false
        },
        
        init() {
            this.initialized = true;
            // Cargar datos iniciales del dashboard
            this.loadDashboardData();
        },
        
        async loadDashboardData() {
            try {
                const response = await fetch('/api/analytics/dashboard');
                if (response.ok) {
                    const data = await response.json();
                    this.sectionData['inicio'] = data;
                }
            } catch (error) {
                console.error('Error loading dashboard data:', error);
                this.sectionData['inicio'] = {
                    current_metrics: { income: 0, expenses: 0, profit: 0 },
                    changes: { income_change: 0, expenses_change: 0, profit_change: 0 }
                };
            }
        },
        
        async loadSection(section) {
            this.currentSection = section;
            this.loading = true;
            
            try {
                let response;
                switch(section) {
                    // Rutas Laborales
                    case 'altas-empleados':
                        response = await fetch('/api/laboral/altas-empleados');
                        break;
                    case 'bajas-empleados':
                        response = await fetch('/api/laboral/bajas-empleados');
                        break;
                    case 'nominas':
                        response = await fetch('/api/laboral/nominas');
                        break;
                    case 'contratos-trabajo':
                        response = await fetch('/api/laboral/contratos');
                        break;
                    case 'calendario-vacaciones':
                        response = await fetch('/api/laboral/calendario-vacaciones');
                        break;
                    case 'liquidacion-ss':
                        response = await fetch('/api/laboral/liquidacion-ss');
                        break;
                    case 'constitucion-empresas':
                        response = await fetch('/api/laboral/constitucion-empresas');
                        break;
                    
                    // Rutas Fiscales
                    case 'modelos-aeat':
                        response = await fetch('/api/fiscal/modelos');
                        break;
                    case 'alta-autonomo-empresa':
                        response = await fetch('/api/fiscal/alta-autonomo');
                        break;
                    case 'libros-obligatorios':
                        response = await fetch('/api/fiscal/libros-obligatorios');
                        break;
                    case 'calendario-fiscal':
                        response = await fetch('/api/fiscal/calendario');
                        break;
                    case 'historico-modelos':
                        response = await fetch('/api/fiscal/historico-modelos');
                        break;
                    
                    // Rutas Contables
                    case 'libro-ingresos':
                        response = await fetch('/api/contable/libro-ingresos');
                        break;
                    case 'libro-gastos':
                        response = await fetch('/api/contable/libro-gastos');
                        break;
                    case 'extractos-bancarios':
                        response = await fetch('/api/contable/extractos-bancarios');
                        break;
                    case 'balance-fiscal':
                        response = await fetch('/api/contable/balance-fiscal');
                        break;
                    
                    // Rutas VTC
                    case 'rehabilitar-autorizacion':
                    case 'transmitir-autorizacion':
                    case 'renunciar-autorizacion':
                    case 'reducir-flota':
                    case 'sustituir-vehiculo':
                    case 'distintivo-vtc':
                    case 'renovar-autorizacion':
                        // Para estas secciones VTC, solo cambiar la vista por ahora
                        this.sectionData[section] = { message: 'Sección cargada - formulario disponible' };
                        this.loading = false;
                        return;
                    
                    // Rutas Gastos
                    case 'combustible':
                        response = await fetch('/api/gastos/combustible');
                        break;
                    case 'seguro':
                        response = await fetch('/api/gastos/seguro');
                        break;
                    case 'compra-vehiculo':
                        response = await fetch('/api/gastos/compra-vehiculo');
                        break;
                    case 'pago-tasas':
                        response = await fetch('/api/gastos/pago-tasas');
                        break;
                    case 'parking':
                        response = await fetch('/api/gastos/parking');
                        break;
                    case 'teletac':
                        response = await fetch('/api/gastos/teletac');
                        break;
                    case 'lavado-coche':
                        response = await fetch('/api/gastos/lavado-coche');
                        break;
                    case 'itv':
                        response = await fetch('/api/gastos/itv');
                        break;
                    case 'taller':
                        response = await fetch('/api/gastos/taller');
                        break;
                    case 'otros-gastos':
                        response = await fetch('/api/gastos/otros');
                        break;
                    
                    // Rutas Ingresos
                    case 'apps-ingresos':
                        response = await fetch('/api/ingresos/apps-ingresos');
                        break;
                    case 'ingresos-tpv':
                        response = await fetch('/api/ingresos/tpv');
                        break;
                    case 'ingresos-efectivo':
                        response = await fetch('/api/ingresos/efectivo');
                        break;
                    case 'facturacion-empresas':
                        response = await fetch('/api/ingresos/empresas');
                        break;
                    case 'transferencia-bancaria':
                        response = await fetch('/api/ingresos/transferencia');
                        break;
                    
                    // Rutas Asistente IA
                    case 'recordatorios':
                        response = await fetch('/api/ia/recordatorios');
                        break;
                    case 'automatizaciones':
                        response = await fetch('/api/ia/automatizaciones');
                        break;
                    
                    default:
                        this.sectionData[section] = { message: 'Sección en desarrollo' };
                        this.loading = false;
                        return;
                }
                
                if (response && response.ok) {
                    const data = await response.json();
                    this.sectionData[section] = data;
                } else {
                    this.sectionData[section] = { error: 'Error al cargar datos' };
                }
            } catch (error) {
                console.error('Error loading section:', error);
                this.sectionData[section] = { error: 'Error de conexión' };
            }
            
            this.loading = false;
        },
        
        getSectionTitle() {
            const titles = {
                'inicio': 'Panel de Control',
                // Laboral
                'altas-empleados': 'Altas de Empleados',
                'bajas-empleados': 'Bajas de Empleados',
                'nominas': 'Gestión de Nóminas',
                'contratos-trabajo': 'Contratos de Trabajo',
                'enviar-nominas': 'Envío de Nóminas Mensual',
                'calendario-vacaciones': 'Calendario de Vacaciones',
                'liquidacion-ss': 'Liquidación de Cuotas S.S.',
                'constitucion-empresas': 'Constitución de Empresas',
                // Fiscal
                'modelos-aeat': 'Modelos AEAT (303, 130, 390, 100, 347, 111, 115)',
                'alta-autonomo-empresa': 'Alta Autónomo/Empresa',
                'libros-obligatorios': 'Libros Obligatorios',
                'calendario-fiscal': 'Calendario Fiscal Automático',
                'historico-modelos': 'Histórico de Modelos Presentados',
                'notificaciones-ayuda': 'Notificaciones y Ayuda Online',
                // Contable
                'libro-ingresos': 'Libro de Ingresos',
                'libro-gastos': 'Libro de Gastos',
                'extractos-bancarios': 'Extractos Bancarios / Conciliación',
                'balance-fiscal': 'Balance Fiscal',
                // Área VTC
                'rehabilitar-autorizacion': 'Rehabilitar Autorización Caducada',
                'transmitir-autorizacion': 'Transmitir Autorización (Cambio Titular)',
                'renunciar-autorizacion': 'Renunciar a la Autorización',
                'reducir-flota': 'Reducir Flota de Vehículos',
                'sustituir-vehiculo': 'Sustituir Vehículo',
                'sustitucion-provisional': 'Sustitución Provisional por Avería',
                'cambiar-domicilio': 'Cambiar de Domicilio',
                'distintivo-vtc': 'Solicitar Distintivo VTC',
                'renovar-autorizacion': 'Renovar Autorización (Visar)',
                // Área Taxi
                'renovacion-vt': 'Renovación de Autorización (VT)',
                'revision-metropolitana': 'Revisión Metropolitana',
                'altas-bajas-vehiculos': 'Altas y Bajas de Vehículos',
                'altas-bajas-asalariados': 'Altas y Bajas de Asalariados',
                'altas-autonomos-familiares': 'Altas de Autónomos y Familiares',
                'sustituir-vehiculo-taxi': 'Sustituir Vehículo',
                // Gastos
                'combustible': 'Combustible',
                'seguro': 'Seguros',
                'compra-vehiculo': 'Compra de Vehículo',
                'pago-tasas': 'Pago de Tasas',
                'parking': 'Parking',
                'teletac': 'Teletac',
                'lavado-coche': 'Lavado del Coche',
                'itv': 'ITV',
                'taller': 'Taller (Mecánico y Chapista)',
                'otros-gastos': 'Otros Gastos',
                // Ingresos
                'apps-ingresos': 'Apps (Uber, Bolt, Cabify)',
                'ingresos-tpv': 'Ingresos por TPV',
                'ingresos-efectivo': 'Ingresos con Efectivo',
                'facturacion-empresas': 'Facturación a Empresas',
                'transferencia-bancaria': 'Transferencia Bancaria',
                // DGT
                'matriculacion-vehiculos': 'Matriculación de Vehículos',
                'transferencia-bajas': 'Transferencia y Bajas de Vehículos',
                'pliegos-descargo': 'Pliegos de Descargo',
                'reformas-vehiculos': 'Reformas de Vehículos',
                'duplicados-permiso': 'Duplicados Permiso de Conducir',
                // Asistente IA
                'responder-preguntas': 'Responder Preguntas',
                'automatizaciones': 'Automatizaciones',
                'recordatorios': 'Recordatorios de Vencimientos'
            };
            return titles[this.currentSection] || 'Dashboard';
        },
        
        openModal(modalType) {
            this.showModal = modalType;
            this.formData = {}; // Reset form data
            
            // Set default values based on modal type
            if (modalType === 'altas-empleados') {
                this.formData = {
                    nombre: '',
                    apellidos: '',
                    dni: '',
                    nss: '',
                    fecha_nacimiento: '',
                    puesto: '',
                    salario: '',
                    fecha_alta: new Date().toISOString().split('T')[0]
                };
            } else if (modalType === 'bajas-empleados') {
                this.formData = {
                    empleado_id: '',
                    fecha_baja: new Date().toISOString().split('T')[0],
                    tipo_baja: '',
                    causa_baja: '',
                    ultimo_dia_trabajado: new Date().toISOString().split('T')[0],
                    indemnizacion: 0,
                    observaciones: ''
                };
            } else if (modalType === 'nominas') {
                this.formData = {
                    empleado_id: '',
                    periodo: '',
                    dias_trabajados: 30,
                    horas_extras: 0,
                    complementos: 0,
                    deducciones: 0
                };
            } else if (modalType === 'modelos-aeat') {
                this.formData = {
                    modelo: '',
                    periodo: '',
                    ejercicio: new Date().getFullYear(),
                    nif: '',
                    iva_devengado: 0,
                    iva_deducible: 0
                };
            } else if (modalType === 'libro-ingresos') {
                this.formData = {
                    fecha: new Date().toISOString().split('T')[0],
                    numero_factura: '',
                    cliente: '',
                    base_imponible: '',
                    tipo_iva: '21',
                    cuota_iva: '',
                    metodo_pago: ''
                };
            } else if (modalType === 'rehabilitar-autorizacion') {
                this.formData = {
                    numero_autorizacion: '',
                    fecha_caducidad: '',
                    nif_titular: '',
                    motivo: ''
                };
            } else if (modalType === 'gastos') {
                this.formData = {
                    tipo_gasto: '',
                    fecha: new Date().toISOString().split('T')[0],
                    proveedor: '',
                    numero_factura: '',
                    importe: '',
                    iva: '21',
                    vehiculo: '',
                    descripcion: ''
                };
            } else if (modalType === 'recordatorios') {
                this.formData = {
                    tipo_recordatorio: '',
                    dias_antelacion: 7,
                    notif_dashboard: true,
                    notif_email: false,
                    notif_sms: false
                };
            } else if (modalType === 'contratos-trabajo') {
                this.formData = {
                    empleado_id: '',
                    tipo_contrato: '',
                    fecha_inicio: new Date().toISOString().split('T')[0],
                    fecha_fin: '',
                    salario: '',
                    jornada: ''
                };
            } else if (modalType === 'libro-gastos') {
                this.formData = {
                    fecha: new Date().toISOString().split('T')[0],
                    proveedor: '',
                    concepto: '',
                    base_imponible: '',
                    tipo_iva: '21',
                    cuota_iva: ''
                };
            } else if (modalType === 'alta-autonomo-empresa') {
                this.formData = {
                    tipo_alta: '',
                    nif_cif: '',
                    nombre_razon: '',
                    actividad_principal: '',
                    cnae: '',
                    fecha_inicio: new Date().toISOString().split('T')[0]
                };
            } else if (modalType === 'transmitir-autorizacion') {
                this.formData = {
                    numero_autorizacion: '',
                    nif_actual: '',
                    nif_nuevo: '',
                    nombre_nuevo: '',
                    fecha_transmision: new Date().toISOString().split('T')[0],
                    motivo: ''
                };
            } else if (modalType === 'calendario-vacaciones') {
                this.formData = {
                    empleado_id: '',
                    tipo_solicitud: '',
                    fecha_inicio: new Date().toISOString().split('T')[0],
                    fecha_fin: '',
                    observaciones: ''
                };
            } else if (modalType === 'enviar-nominas') {
                this.formData = {
                    mes: new Date().toISOString().slice(0, 7),
                    metodo_envio: ''
                };
            } else if (modalType === 'liquidacion-ss') {
                this.formData = {
                    mes_liquidacion: new Date().toISOString().slice(0, 7),
                    tipo_liquidacion: 'normal'
                };
            } else if (modalType === 'constitucion-empresas') {
                this.formData = {
                    forma_juridica: '',
                    denominacion: '',
                    capital_social: '',
                    numero_socios: 1,
                    objeto_social: '',
                    domicilio_social: ''
                };
            } else if (modalType === 'ingresos-apps') {
                this.formData = {
                    app: '',
                    fecha: new Date().toISOString().split('T')[0],
                    importe_bruto: '',
                    comision: '',
                    numero_servicios: 1,
                    vehiculo: '',
                    observaciones: ''
                };
            } else if (modalType === 'ingresos-tpv') {
                this.formData = {
                    fecha: new Date().toISOString().split('T')[0],
                    tipo_tarjeta: '',
                    importe: '',
                    comision_tpv: '',
                    referencia: '',
                    vehiculo: '',
                    descripcion: ''
                };
            } else if (modalType === 'ingresos-efectivo') {
                this.formData = {
                    fecha: new Date().toISOString().split('T')[0],
                    importe_total: '',
                    numero_servicios: 1,
                    importe_promedio: '',
                    vehiculo: '',
                    turno: '',
                    observaciones: ''
                };
            } else if (modalType === 'facturacion-empresas') {
                this.formData = {
                    empresa_cliente: '',
                    cif_nif: '',
                    numero_factura: '',
                    fecha_factura: new Date().toISOString().split('T')[0],
                    base_imponible: '',
                    tipo_iva: '21',
                    forma_pago: '',
                    estado: 'emitida',
                    concepto: ''
                };
            } else if (modalType === 'transferencia-bancaria') {
                this.formData = {
                    fecha_transferencia: new Date().toISOString().split('T')[0],
                    importe: '',
                    cliente: '',
                    referencia: '',
                    cuenta_destino: '',
                    tipo_servicio: '',
                    concepto: ''
                };
            } else if (modalType === 'renunciar-autorizacion') {
                this.formData = {
                    numero_autorizacion: '',
                    nif_titular: '',
                    fecha_renuncia: new Date().toISOString().split('T')[0],
                    motivo_renuncia: '',
                    vehiculos_afectados: 1,
                    fecha_efectiva: new Date().toISOString().split('T')[0],
                    observaciones: ''
                };
            } else if (modalType === 'reducir-flota') {
                this.formData = {
                    numero_autorizacion: '',
                    vehiculos_actuales: 5,
                    vehiculos_reducir: 1,
                    vehiculos_resultantes: 4,
                    fecha_reduccion: new Date().toISOString().split('T')[0],
                    motivo_reduccion: '',
                    vehiculo_1234_abc: false,
                    vehiculo_5678_def: false,
                    justificacion: ''
                };
            } else if (modalType === 'sustituir-vehiculo-vtc') {
                this.formData = {
                    matricula_actual: '',
                    marca_modelo_actual: '',
                    motivo_sustitucion: '',
                    fecha_sustitucion: new Date().toISOString().split('T')[0],
                    matricula_nueva: '',
                    marca_modelo_nuevo: '',
                    año_vehiculo: new Date().getFullYear(),
                    numero_bastidor: '',
                    numero_plazas: 4,
                    color_vehiculo: ''
                };
            } else if (modalType === 'sustitucion-provisional') {
                this.formData = {
                    matricula_averiado: '',
                    fecha_averia: new Date().toISOString().split('T')[0],
                    tipo_averia: '',
                    tiempo_reparacion: '',
                    matricula_sustituto: '',
                    marca_modelo_sustituto: '',
                    fecha_inicio_sustitucion: new Date().toISOString().split('T')[0],
                    fecha_fin_estimada: '',
                    descripcion_averia: ''
                };
            } else if (modalType === 'cambiar-domicilio') {
                this.formData = {
                    direccion_actual: 'Calle Mayor, 123',
                    cp_actual: '28001',
                    localidad_actual: 'Madrid',
                    provincia_actual: 'Madrid',
                    direccion_nueva: '',
                    cp_nuevo: '',
                    localidad_nueva: '',
                    provincia_nueva: '',
                    fecha_cambio: new Date().toISOString().split('T')[0],
                    motivo_cambio: ''
                };
            } else if (modalType === 'distintivo-vtc') {
                this.formData = {
                    numero_autorizacion: '',
                    matricula_vehiculo: '',
                    tipo_distintivo: '',
                    cantidad: 1,
                    direccion_envio: '',
                    telefono: '',
                    fecha_incidente: '',
                    numero_denuncia: '',
                    descripcion_incidente: ''
                };
            } else if (modalType === 'renovar-autorizacion-vtc') {
                this.formData = {
                    numero_autorizacion: '',
                    fecha_vencimiento: '',
                    nif_titular: '',
                    fecha_solicitud: new Date().toISOString().split('T')[0],
                    numero_vehiculos: 1,
                    estado_actividad: '',
                    vehiculo1_matricula: '',
                    vehiculo1_marca: '',
                    vehiculo1_año: '',
                    doc_seguro: false,
                    doc_itv: false,
                    doc_circulacion: false,
                    doc_fiscal: false
                };
            } else if (modalType === 'matriculacion-vehiculos') {
                this.formData = {
                    tipo_vehiculo: '',
                    marca: '',
                    modelo: '',
                    año: new Date().getFullYear(),
                    bastidor: '',
                    color: '',
                    combustible: '',
                    cilindrada: '',
                    plazas: 5,
                    peso_maximo: '',
                    nif_titular: '',
                    nombre_titular: '',
                    direccion_titular: ''
                };
            } else if (modalType === 'transferencia-bajas') {
                this.formData = {
                    tipo_tramite: '',
                    matricula: '',
                    nif_nuevo_titular: '',
                    nombre_nuevo_titular: '',
                    direccion_nuevo_titular: '',
                    motivo_baja: '',
                    duracion_baja: '',
                    observaciones: ''
                };
            } else if (modalType === 'pliegos-descargo') {
                this.formData = {
                    numero_expediente: '',
                    fecha_infraccion: '',
                    matricula: '',
                    importe_multa: '',
                    tipo_infraccion: '',
                    lugar_infraccion: '',
                    motivo_identificacion: false,
                    motivo_prescripcion: false,
                    motivo_procedimiento: false,
                    motivo_otros: false,
                    alegaciones: ''
                };
            } else if (modalType === 'reformas-vehiculos') {
                this.formData = {
                    matricula: '',
                    tipo_reforma: '',
                    fecha_reforma: new Date().toISOString().split('T')[0],
                    taller_autorizado: '',
                    nueva_cilindrada: '',
                    nueva_potencia: '',
                    combustible_anterior: '',
                    combustible_nuevo: '',
                    descripcion_reforma: '',
                    doc_proyecto_tecnico: false,
                    doc_certificado_taller: false,
                    doc_fotos: false
                };
            } else if (modalType === 'duplicados-permiso') {
                this.formData = {
                    nif: '',
                    numero_permiso: '',
                    motivo_duplicado: '',
                    fecha_incidente: new Date().toISOString().split('T')[0],
                    clase_b: false,
                    clase_c: false,
                    clase_d: false,
                    clase_a: false,
                    fecha_vencimiento: '',
                    numero_denuncia: '',
                    comisaria: '',
                    direccion_envio: '',
                    observaciones: ''
                };
            }
        },
        
        async submitForm(formType) {
            try {
                let endpoint = '';
                let method = 'POST';
                
                // Determine endpoint based on form type
                switch(formType) {
                    case 'altas-empleados':
                        endpoint = '/api/laboral/altas-empleados';
                        break;
                    case 'bajas-empleados':
                        endpoint = '/api/laboral/bajas-empleados';
                        break;
                    case 'nominas':
                        endpoint = '/api/laboral/nominas';
                        break;
                    case 'modelos-aeat':
                        endpoint = '/api/fiscal/modelos';
                        break;
                    case 'libro-ingresos':
                        endpoint = '/api/contable/libro-ingresos';
                        break;
                    case 'rehabilitar-autorizacion':
                        endpoint = '/api/vtc/rehabilitar-autorizacion';
                        break;
                    case 'gastos':
                        endpoint = '/api/gastos/' + this.formData.tipo_gasto;
                        break;
                    case 'recordatorios':
                        endpoint = '/api/ia/recordatorios';
                        break;
                    case 'contratos-trabajo':
                        endpoint = '/api/laboral/contratos';
                        break;
                    case 'libro-gastos':
                        endpoint = '/api/contable/libro-gastos';
                        break;
                    case 'alta-autonomo-empresa':
                        endpoint = '/api/fiscal/alta-autonomo';
                        break;
                    case 'transmitir-autorizacion':
                        endpoint = '/api/vtc/transmitir-autorizacion';
                        break;
                    case 'calendario-vacaciones':
                        endpoint = '/api/laboral/calendario-vacaciones';
                        break;
                    case 'enviar-nominas':
                        endpoint = '/api/laboral/enviar-nominas';
                        break;
                    case 'liquidacion-ss':
                        endpoint = '/api/laboral/liquidacion-ss';
                        break;
                    case 'constitucion-empresas':
                        endpoint = '/api/laboral/constitucion-empresas';
                        break;
                    case 'ingresos-apps':
                        endpoint = '/api/ingresos/apps';
                        break;
                    case 'ingresos-tpv':
                        endpoint = '/api/ingresos/tpv';
                        break;
                    case 'ingresos-efectivo':
                        endpoint = '/api/ingresos/efectivo';
                        break;
                    case 'facturacion-empresas':
                        endpoint = '/api/ingresos/empresas';
                        break;
                    case 'transferencia-bancaria':
                        endpoint = '/api/ingresos/transferencia';
                        break;
                    case 'renunciar-autorizacion':
                        endpoint = '/api/vtc/renunciar-autorizacion';
                        break;
                    case 'reducir-flota':
                        endpoint = '/api/vtc/reducir-flota';
                        break;
                    case 'sustituir-vehiculo-vtc':
                        endpoint = '/api/vtc/sustituir-vehiculo';
                        break;
                    case 'sustitucion-provisional':
                        endpoint = '/api/vtc/sustitucion-provisional';
                        break;
                    case 'cambiar-domicilio':
                        endpoint = '/api/vtc/cambiar-domicilio';
                        break;
                    case 'distintivo-vtc':
                        endpoint = '/api/vtc/distintivo';
                        break;
                    case 'renovar-autorizacion-vtc':
                        endpoint = '/api/vtc/renovar-autorizacion';
                        break;
                    case 'matriculacion-vehiculos':
                        endpoint = '/api/dgt/matriculacion';
                        break;
                    case 'transferencia-bajas':
                        endpoint = '/api/dgt/transferencia-bajas';
                        break;
                    case 'pliegos-descargo':
                        endpoint = '/api/dgt/pliegos-descargo';
                        break;
                    case 'reformas-vehiculos':
                        endpoint = '/api/dgt/reformas';
                        break;
                    case 'duplicados-permiso':
                        endpoint = '/api/dgt/duplicados-permiso';
                        break;
                    default:
                        throw new Error('Tipo de formulario no reconocido');
                }
                
                const response = await fetch(endpoint, {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(this.formData)
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    alert('Datos enviados correctamente');
                    this.showModal = null;
                    // Reload section data if needed
                    if (this.currentSection.includes(formType)) {
                        this.loadSection(this.currentSection);
                    }
                } else {
                    alert(result.message || 'Error al enviar los datos');
                }
                
            } catch (error) {
                console.error('Error submitting form:', error);
                alert('Error de conexión. Inténtalo de nuevo.');
            }
        }
    }
}

// Chat IA functionality
async function sendMessage() {
    const input = document.getElementById('chatInput');
    const messages = document.getElementById('chatMessages');
    const message = input.value.trim();
    
    if (message) {
        // Add user message
        const userDiv = document.createElement('div');
        userDiv.className = 'bg-white p-3 rounded-lg border';
        userDiv.innerHTML = `<p class="text-sm"><strong>Tú:</strong> ${message}</p>`;
        messages.appendChild(userDiv);
        
        // Show typing indicator
        const typingDiv = document.createElement('div');
        typingDiv.className = 'bg-blue-100 p-3 rounded-lg';
        typingDiv.innerHTML = `<p class="text-sm"><strong>Asistente:</strong> <i class="fas fa-spinner fa-spin"></i> Escribiendo...</p>`;
        messages.appendChild(typingDiv);
        
        try {
            // Call IA API
            const response = await fetch('/api/ia/pregunta', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ pregunta: message })
            });
            
            const data = await response.json();
            
            // Remove typing indicator
            messages.removeChild(typingDiv);
            
            // Add AI response
            const aiDiv = document.createElement('div');
            aiDiv.className = 'bg-blue-100 p-3 rounded-lg';
            aiDiv.innerHTML = `<p class="text-sm"><strong>Asistente:</strong> ${data.respuesta || 'Lo siento, no pude procesar tu consulta.'}</p>`;
            messages.appendChild(aiDiv);
            
        } catch (error) {
            console.error('Error calling IA API:', error);
            
            // Remove typing indicator
            messages.removeChild(typingDiv);
            
            // Show error message
            const errorDiv = document.createElement('div');
            errorDiv.className = 'bg-red-100 p-3 rounded-lg';
            errorDiv.innerHTML = `<p class="text-sm"><strong>Error:</strong> No se pudo conectar con el asistente. Inténtalo de nuevo.</p>`;
            messages.appendChild(errorDiv);
        }
        
        input.value = '';
        messages.scrollTop = messages.scrollHeight;
    }
}

// Enter key support for chat
document.addEventListener('DOMContentLoaded', function() {
    const chatInput = document.getElementById('chatInput');
    if (chatInput) {
        chatInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    }
    
    // Initialize dashboard
    document.addEventListener('alpine:init', () => {
        Alpine.data('dashboard').init();
    });
    
    // Initialize chart if on home section
    setTimeout(() => {
        const ctx = document.getElementById('incomeChart');
        if (ctx) {
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Ingresos',
                        data: [12000, 13500, 11800, 14200, 12450, 13800],
                        borderColor: 'rgb(59, 130, 246)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.3
                    }, {
                        label: 'Gastos',
                        data: [3200, 3400, 2900, 3600, 3200, 3500],
                        borderColor: 'rgb(239, 68, 68)',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
    }, 100);
});
</script>
{% endblock %}